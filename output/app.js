(()=>{function Sc(n){return function(r){return function(){n.strokeStyle=r}}}var y_=function(n){return function(r){for(var t=r.length,e=new Array(t),a=0;a<t;a++)e[a]=n(r[a]);return e}};var ei={compose:function(n){return function(r){return function(t){return n(r(t))}}}};var X=function(n){return n.identity},Y={identity:function(n){return n},Semigroupoid0:function(){return ei}};var Sn=!0;var fn=function(n){return function(r){return function(t){return n(t)(r)}}},$=function(n){return function(r){return n}};var Ar=function(){function n(){}return n.value=new n,n}();var g=function(n){return n.map};var qn=function(n){return g(n)($(void 0))},Wa=function(n){var r=g(n);return function(t){return function(e){return r($(e))(t)}}},Rc=function(n){var r=g(n);return function(t){return r($(t))}};var vr={map:y_};var h_=function(n){return function(r){return n.length===0?r:r.length===0?n:n.concat(r)}};var Kr=function(n){return n.reflectSymbol};var at={append:h_};var q=function(n){return n.append};var T_=function(n){return function(r){for(var t=n.length,e=r.length,a=new Array(t*e),o=0,i=0;i<t;i++)for(var c=n[i],f=0;f<e;f++)a[o++]=c(r[f]);return a}};var Ub=X(Y);var oi={apply:T_,Functor0:function(){return vr}},Cn=function(n){return n.apply},C_=function(n){var r=Cn(n),t=g(n.Functor0());return function(e){return function(a){return r(t($)(e))(a)}}},Mt=function(n){var r=Cn(n),t=g(n.Functor0());return function(e){return function(a){return r(t($(Ub))(e))(a)}}};var T=function(n){return n.pure},Ao=function(n){var r=T(n);return function(t){return function(e){if(!t)return e;if(t)return r(void 0);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[t.constructor.name,e.constructor.name])}}},$t=function(n){var r=T(n);return function(t){return function(e){if(t)return e;if(!t)return r(void 0);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[t.constructor.name,e.constructor.name])}}},No=function(n){var r=Cn(n.Apply0()),t=T(n);return function(e){return function(a){return r(t(e))(a)}}};var M_=function(n){return function(r){for(var t=[],e=0,a=n.length;e<a;e++)Array.prototype.push.apply(t,r(n[e]));return t}};var zb=X(Y),Ft=function(n){return n.discard};var ui={bind:M_,Apply0:function(){return oi}},x=function(n){return n.bind},Yn=function(n){return fn(x(n))},So=function(n){var r=Yn(n);return function(t){return function(e){return function(a){return r(t)(e(a))}}}},ii=function(n){var r=x(n);return function(t){return function(e){return function(a){return r(t(a))(e)}}}};var wt={discard:function(n){return x(n)}};var Ho=function(n){var r=x(n);return function(t){return r(t)(zb)}};var fe=function(n){return function(r){for(var t=n>r?-1:1,e=new Array(t*(r-n)+1),a=n,o=0;a!==r;)e[o++]=a,a+=t;return e[o]=a,e}},Vb=function(n){return function(r){if(n<1)return[];var t=new Array(n);return t.fill(r)}},Jb=function(n){return function(r){for(var t=[],e=0,a=0;a<n;a++)t[e++]=r;return t}},F_=typeof Array.prototype.fill=="function"?Vb:Jb,w_=function(){function n(a,o){this.head=a,this.tail=o}var r={};function t(a){return function(o){return new n(a,o)}}function e(a){for(var o=[],i=0,c=a;c!==r;)o[i++]=c.head,c=c.tail;return o}return function(a){return function(o){return e(a(t)(r)(o))}}}(),ot=function(n){return n.length};var L_=function(n){return function(r){return function(t){return function(e){return e<0||e>=t.length?r:n(t[e])}}}};var I_=function(n){return function(r){return function(t){return function(e){for(var a=0,o=e.length;a<o;a++)if(t(e[a]))return n(a);return r}}}};var x_=function(n){return function(r){return function(t){return function(e){if(t<0||t>=e.length)return r;var a=e.slice();return a.splice(t,1),n(a)}}}};var A_=function(){function n(r,t,e,a,o,i){var c,f,l,s,m,d,p;for(c=o+(i-o>>1),c-o>1&&n(r,t,a,e,o,c),i-c>1&&n(r,t,a,e,c,i),f=o,l=c,s=o;f<c&&l<i;)m=a[f],d=a[l],p=t(r(m)(d)),p>0?(e[s++]=d,++l):(e[s++]=m,++f);for(;f<c;)e[s++]=a[f++];for(;l<i;)e[s++]=a[l++]}return function(r){return function(t){return function(e){var a;return e.length<2?e:(a=e.slice(0),n(r,t,a,e.slice(0),0,e.length),a)}}}}();var fi=function(n){return function(r){return function(t){for(var e=r.length<t.length?r.length:t.length,a=new Array(e),o=0;o<e;o++)a[o]=n(r[o])(t[o]);return a}}};var Gb=function(n,r,t){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return e=1,a=t(),e=2,a}};var Oa=function(n){return n.defer},N_=function(n){var r=Oa(n);return function(t){var e=Gb("go","Control.Lazy",function(){return r(function(o){return t(e(25))})}),a=e(25);return a}};var H_=function(n){var r=x(n.Bind1()),t=Ao(n.Applicative0());return function(e){return function(a){return r(e)(function(o){return t(o)(a)})}}};var $r=function(n){var r=x(n.Bind1()),t=T(n.Applicative0());return function(e){return function(a){return r(e)(function(o){return r(a)(function(i){return t(o(i))})})}}};var R_=String.fromCharCode(65535),W_=String.fromCharCode(0),jb=Number.POSITIVE_INFINITY,Kb=Number.NEGATIVE_INFINITY;var ci=function(n){return function(r){return function(t){return function(e){return function(a){return e<a?n:e===a?r:t}}}}};var P_=ci,O_=ci,$_=ci,q_=ci;var Wo=function(n){return function(r){return n===r}},U_=Wo,B_=Wo,k_=Wo,z_=Wo,V_=Wo;var Pc={eq:function(n){return function(r){return!0}}},Ie={eq:V_};var li={eq:k_},fa={eq:B_},J_={eq:z_},Oc={eq:U_};var on=function(n){return n.eq},nT=on(Oc);var Po=function(n){var r=on(n);return function(t){return function(e){return nT(r(t)(e))(!1)}}};var L=function(){function n(){}return n.value=new n,n}(),A=function(){function n(){}return n.value=new n,n}(),N=function(){function n(){}return n.value=new n,n}();var $a={eq:function(n){return function(r){return n instanceof L&&r instanceof L||n instanceof A&&r instanceof A||n instanceof N&&r instanceof N}}};var Q_=function(n){return function(r){return n-r|0}};var G_=function(n){return function(r){return n+r|0}},j_=function(n){return function(r){return n*r|0}};var Nr=function(n){return n.zero};var Oo={add:G_,zero:0,mul:j_,one:1};var mt=function(n){return n.one};var Xr=function(n){return n.mul};var ut=function(n){return n.add};var qa=function(n){return n.sub};var si={sub:Q_,Semiring0:function(){return Oo}};var pi=function(n){var r=qa(n),t=Nr(n.Semiring0());return function(e){return r(t)(e)}};var $o={compare:function(n){return function(r){return N.value}},Eq0:function(){return Pc}},Vr=function(){return{compare:$_(L.value)(N.value)(A.value),Eq0:function(){return Ie}}}();var qo=function(){return{compare:O_(L.value)(N.value)(A.value),Eq0:function(){return li}}}(),wn=function(){return{compare:P_(L.value)(N.value)(A.value),Eq0:function(){return fa}}}(),mi=function(){return{compare:q_(L.value)(N.value)(A.value),Eq0:function(){return J_}}}();var B=function(n){return n.compare};var vi=function(n){var r=B(n);return function(t){return function(e){return function(a){return r(t(e))(t(a))}}}},$c=function(n){var r=B(n);return function(t){return function(e){var a=r(t)(e);return a instanceof A}}},Z_=function(n){var r=B(n);return function(t){return function(e){var a=r(t)(e);return!(a instanceof L)}}},qc=function(n){var r=B(n);return function(t){return function(e){var a=r(t)(e);return a instanceof L}}},nm=function(n){var r=qc(n),t=$c(n);return function(e){var a=e.Semiring0(),o=Nr(a),i=pi(e),c=mt(a);return function(f){var l=r(f)(o);if(l)return i(c);var s=t(f)(o);return s?c:f}}};var Ua=function(n){var r=B(n);return function(t){return function(e){var a=r(t)(e);if(a instanceof L)return e;if(a instanceof N||a instanceof A)return t;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[a.constructor.name])}}},Uc=function(n){var r=B(n);return function(t){return function(e){var a=r(t)(e);if(a instanceof L||a instanceof N)return t;if(a instanceof A)return e;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[a.constructor.name])}}};var rm=function(n){var r=Uc(n),t=Ua(n);return function(e){return function(a){return function(o){return r(a)(t(e)(o))}}}};var di=function(n){var r=Z_(n);return function(t){var e=Nr(t.Semiring0()),a=pi(t);return function(o){var i=r(o)(e);return i?o:a(o)}}};var qt=function(n){return n.top};var Di={top:2147483647,bottom:-2147483648,Ord0:function(){return wn}},Uo={top:R_,bottom:W_,Ord0:function(){return mi}};var ce=function(n){return n.bottom};var tm=function(n){return n.toString()};var la={show:tm};var un=function(n){return n.show};var sT=X(Y),D=function(){function n(){}return n.value=new n,n}(),v=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var Hn=function(n){return function(r){return function(t){if(t instanceof D)return n;if(t instanceof v)return r(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},pe=Hn(!0)($(!1)),Ba=Hn(!1)($(!0));var xn={map:function(n){return function(r){return r instanceof v?new v(n(r.value0)):D.value}}},pT=g(xn);var Un=function(n){return Hn(n)(sT)},Lt=function(){return function(n){if(n instanceof v)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}};var gi={apply:function(n){return function(r){if(n instanceof v)return pT(n.value0)(r);if(n instanceof D)return D.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[n.constructor.name,r.constructor.name])}},Functor0:function(){return xn}};var Dr={bind:function(n){return function(r){if(n instanceof v)return r(n.value0);if(n instanceof D)return D.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[n.constructor.name,r.constructor.name])}},Apply0:function(){return gi}};var gn=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),yn=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var Bo={map:function(n){return function(r){if(r instanceof gn)return new gn(r.value0);if(r instanceof yn)return new yn(n(r.value0));throw new Error("Failed pattern match at Data.Either (line 0, column 0 - line 0, column 0): "+[r.constructor.name])}}};var vt=function(n){return function(r){return function(t){if(t instanceof gn)return n(t.value0);if(t instanceof yn)return r(t.value0);throw new Error("Failed pattern match at Data.Either (line 208, column 1 - line 208, column 64): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}};var xe=function(n){return n};var ko={map:function(n){return function(r){return n(r)}}};var em={apply:function(n){return function(r){return n(r)}},Functor0:function(){return ko}},_T={bind:function(n){return function(r){return r(n)}},Apply0:function(){return em}},mT={pure:xe,Apply0:function(){return em}},Ae={Applicative0:function(){return mT},Bind1:function(){return _T}};var am=function(n){return Math.min(Math.abs(n),2147483647)},om=function(n){return function(r){return r===0?0:r>0?Math.floor(n/r):-Math.floor(n/-r)}},um=function(n){return function(r){if(r===0)return 0;var t=Math.abs(r);return(n%t+t)%t}};var im={Ring0:function(){return si}};var dt=function(n){return n.mod},zo=function(n){var r=on(n);return function(t){var e=Nr(t.CommutativeRing0().Ring0().Semiring0()),a=dt(t);return function(o){return function(i){var c=r(i)(e);return c?o:zo(n)(t)(i)(a(o)(i))}}}};var Fr={degree:am,div:om,mod:um,CommutativeRing0:function(){return im}},it=function(n){return n.div};var En=function(n){return n.mempty};var fm=function(n){return function(){return n}},cm=function(n){return function(r){return function(){return r(n())()}}};var yi=function(n){return function(r){return function(){for(var t=0,e=n.length;t<e;t++)r(n[t])()}}};var lm=function(n,r,t){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return e=1,a=t(),e=2,a}},me={Applicative0:function(){return Gn},Bind1:function(){return ft}},ft={bind:cm,Apply0:function(){return zc(0)}},Gn={pure:fm,Apply0:function(){return zc(0)}},sm=lm("functorEffect","Effect",function(){return{map:No(Gn)}}),zc=lm("applyEffect","Effect",function(){return{apply:$r(me),Functor0:function(){return sm(0)}}}),sn=sm(20),Vo=zc(23);var pm=function(n){return function(){return{value:n}}};var z=function(n){return function(){return n.value}},_m=function(n){return function(r){return function(){var t=n(r.value);return r.value=t.state,t.value}}},Pn=function(n){return function(r){return function(){r.value=n}}};var bT=qn(sn),jn=pm,Vc=_m,mm=function(n){return Vc(function(r){var t=n(r);return{state:t,value:t}})},ct=function(n){return function(r){return bT(mm(n)(r))}};var ET=Yn(ft),MT=g(sn),pr=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),sr=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),lt=function(n){return n.tailRecM};var vm={tailRecM:function(n){return function(r){var t=function(e){if(e instanceof sr)return e.value0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 137, column 30 - line 137, column 44): "+[e.constructor.name])};return function(){var a=ET(jn)(n(r))();return function(){for(;!function(){var i=z(a)();if(i instanceof pr){var c=n(i.value0)();return Pn(c)(a)(),!1}if(i instanceof sr)return!0;throw new Error("Failed pattern match at Control.Monad.Rec.Class (line 128, column 22 - line 133, column 28): "+[i.constructor.name])}(););return{}}(),MT(t)(z(a))()}}},Monad0:function(){return me}};var dm=function(n){var r=lt(n),t=Rc(n.Monad0().Bind1().Apply0().Functor0());return function(e){return r(function(a){return t(new pr(a))(e)})(void 0)}};var Dm=function(n){return function(r){return function(){return n(r())}}},gm=function(n){return function(){return n}},ym=function(n){return function(r){return function(){return r(n())()}}};var hi=function(n){return function(r){return function(){for(var t=0,e=n.length;t<e;t++)r(n[t])()}}};var IT=function(n,r,t){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return e=1,a=t(),e=2,a}};var pa={map:Dm};var Gc={Applicative0:function(){return ka},Bind1:function(){return bi}},bi={bind:ym,Apply0:function(){return Cm(0)}},ka={pure:gm,Apply0:function(){return Cm(0)}},Cm=IT("applyST","Control.Monad.ST.Internal",function(){return{apply:$r(Gc),Functor0:function(){return pa}}});var jc=function(n){return function(r){return function(){return r.push.apply(r,n)}}};var ma=function(n){return function(){return n}},Kc=function(n){return function(){return n}};var xT=function(){function n(r,t,e,a,o,i){var c,f,l,s,m,d,p;for(c=o+(i-o>>1),c-o>1&&n(r,t,a,e,o,c),i-c>1&&n(r,t,a,e,c,i),f=o,l=c,s=o;f<c&&l<i;)m=a[f],d=a[l],p=t(r(m)(d)),p>0?(e[s++]=d,++l):(e[s++]=m,++f);for(;f<c;)e[s++]=a[f++];for(;l<i;)e[s++]=a[l++]}return function(r){return function(t){return function(e){return function(){return e.length<2||n(r,t,e,e.slice(0),0,e.length),e}}}}}();var Jo=function(n){return jc([n])};var Mm=function(n){return function(r){return n&&r}},Fm=function(n){return function(r){return n||r}},wm=function(n){return!n};var Qo=function(n){return n.tt};var ve=function(n){return n.not};var Yc=function(n){return n.implies};var Go=function(n){return n.ff};var za=function(n){return n.disj},It={ff:!1,tt:!0,implies:function(n){return function(r){return za(It)(ve(It)(n))(r)}},conj:Mm,disj:Fm,not:wm};var jo=function(n){return n.conj},Ci=function(n){var r=Go(n),t=Qo(n),e=Yc(n),a=jo(n),o=za(n),i=ve(n);return{ff:function(c){return r},tt:function(c){return t},implies:function(c){return function(f){return function(l){return e(c(l))(f(l))}}},conj:function(c){return function(f){return function(l){return a(c(l))(f(l))}}},disj:function(c){return function(f){return function(l){return o(c(l))(f(l))}}},not:function(c){return function(f){return i(c(f))}}}};var Im=function(n){return function(r){return function(t){for(var e=r,a=t.length,o=a-1;o>=0;o--)e=n(t[o])(e);return e}}},xm=function(n){return function(r){return function(t){for(var e=r,a=t.length,o=0;o<a;o++)e=n(e)(t[o]);return e}}};var Jr=function(n){return n.empty};var I=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var Kn=function(n){return n.value1};var va={map:function(n){return function(r){return new I(r.value0,n(r.value1))}}};var Hr=function(n){return n.value0};var Nm=function(n){var r=on(n);return function(t){var e=on(t);return{eq:function(a){return function(o){return r(a.value0)(o.value0)&&e(a.value1)(o.value1)}}}}},Ko=function(n){var r=B(n),t=Nm(n.Eq0());return function(e){var a=B(e),o=t(e.Eq0());return{compare:function(i){return function(c){var f=r(i.value0)(c.value0);return f instanceof L?L.value:f instanceof A?A.value:a(i.value1)(c.value1)}},Eq0:function(){return o}}}};var de=function(n){return n.bimap};var y=function(n){return n};var Fi=function(){return y};var VT=Fi();var gr=function(){return VT};var Bn=function(n){return n.foldr};var cr=function(n){var r=Mt(n.Apply0()),t=T(n);return function(e){var a=Bn(e);return function(o){return a(function(i){return r(o(i))})(t(void 0))}}},Li=function(n){var r=cr(n);return function(t){return fn(r(t))}};var Tn=function(n){return n.foldl};var yr={foldr:function(n){return function(r){return function(t){if(t instanceof D)return r;if(t instanceof v)return n(t.value0)(r);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},foldl:function(n){return function(r){return function(t){if(t instanceof D)return r;if(t instanceof v)return n(r)(t.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}},foldMap:function(n){var r=En(n);return function(t){return function(e){if(e instanceof D)return r;if(e instanceof v)return t(e.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[t.constructor.name,e.constructor.name])}}}};var Pm=function(n){var r=Bn(n);return function(t){var e=q(t.Semigroup0()),a=En(t);return function(o){return r(function(i){return function(c){return e(o(i))(c)}})(a)}}},pt={foldr:Im,foldl:xm,foldMap:function(n){return Pm(pt)(n)}};var _r=function(n){return n.foldMap};var YT=function(){function n(a){return[a]}function r(a){return function(o){return[a,o]}}function t(a){return function(o){return function(i){return[a,o,i]}}}function e(a){return function(o){return a.concat(o)}}return function(a){return function(o){return function(i){return function(c){return function(f){function l(s,m){switch(m-s){case 0:return i([]);case 1:return o(n)(c(f[s]));case 2:return a(o(r)(c(f[s])))(c(f[s+1]));case 3:return a(a(o(t)(c(f[s])))(c(f[s+1])))(c(f[s+2]));default:var d=s+Math.floor((m-s)/4)*2;return a(o(e)(l(s,d)))(l(d,m))}}return l(0,f.length)}}}}}}();var Qm=function(n){return function(r){return function(t){return function(e){return function(a){return function(o){for(var i=[],c=o;;){var f=a(c);if(n(f))return i;var l=r(f);i.push(t(l)),c=e(l)}}}}}}};var Gm=function(n){return function(r){return function(t){return function(e){return function(a){return function(o){for(var i=[],c=o;;){var f=a(c);i.push(t(f));var l=e(f);if(n(l))return i;c=r(l)}}}}}}};var UC=Lt();var ml={unfoldr1:Gm(pe)(UC)(Hr)(Kn)};var kC=Lt(),Bt=function(n){return n.unfoldr};var eu={unfoldr:Qm(pe)(kC)(Hr)(Kn),Unfoldable10:function(){return ml}};var XC=g(pa),YC=$t(ka),ZC=qn(pa);var n0=g(vr),Zm=Lt(),r0=Po($a);var t0=q(at);var Dl=function(n){return A_(n)(function(r){if(r instanceof A)return 1;if(r instanceof N)return 0;if(r instanceof L)return-1;throw new Error("Failed pattern match at Data.Array (line 870, column 31 - line 873, column 11): "+[r.constructor.name])})},gl=function(n){var r=vi(n);return function(t){return Dl(r(t))}},e0=gl(wn);var nv=function(n){return[n]};var Hi=function(n){return function(r){return fi(n)(fe(0)(ot(r)-1|0))(r)}};var Qa=function(){return L_(v.create)(D.value)}(),rv=function(n){return Qa(n)(ot(n)-1|0)};var tv=function(n){return Qa(n)(0)},ev=function(n){return function(r){var t=Dl(function(a){return function(o){return n(Kn(a))(Kn(o))}})(Hi(I.create)(r)),e=tv(t);if(e instanceof D)return[];if(e instanceof v)return n0(Kn)(e0(Hr)(function(){var o=Kc(nv(e.value0))();return hi(t)(function(i){return function(){var f=XC(function(){var l=function(s){return Zm(rv(s))};return function(s){return Kn(l(s))}}())(ma(o))();return YC(r0(n(f)(i.value1))(N.value))(ZC(Jo(i)(o)))()}})(),ma(o)()}()));throw new Error("Failed pattern match at Data.Array (line 1085, column 17 - line 1093, column 29): "+[e.constructor.name])}},yl=function(n){return ev(B(n))};var au=function(n){return w_(Bn(n))};var hl=Tn(pt);var av=function(){return I_(v.create)(D.value)}();var ov=function(){return x_(v.create)(D.value)}(),bl=function(n){return function(r){return function(t){return t.length===0?[]:Hn(t)(function(e){return Zm(ov(e)(t))})(av(n(r))(t))}}};var Tl=function(n){return function(r){return t0([n])(r)}};var uv=fn(x(ui));var a0=function(){function n(i){this.fn=i}var r={},t=function(i,c){this.head=i,this.tail=c};function e(i){return new t(i,r)}function a(i){return function(c){return new t(i,c)}}function o(i){for(var c=[],f=i;f!==r;)c.push(f.head),f=f.tail;return c}return function(i){return function(c){return function(f){var l=function(m,d){return i(c(a)(f(m)))(d)},s=function(m,d,p){if(d===0)return m;var u=p[d-1];return new n(function(){var _=s(l(u,m),d-1,p);return _})};return function(m){for(var d=c(e)(f(m[m.length-1])),p=s(d,m.length-1,m);p instanceof n;)p=p.fn();return c(o)(p)}}}}}();var Re=function(n){return n.mapWithIndex};var Ga=function(n){return n.foldrWithIndex};var ou=function(n){return n.foldlWithIndex};var xt=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var Wi=function(n){var r=Jr(n);return function(t){return new xt(t,r)}};var lv=function(n){return function(r){return function(t){return(t|0)===t?n(t):r}}},On=function(n){return n},sv=function(n){return function(r){return function(t){var e;t<11?e="[0-"+(t-1).toString()+"]":t===11?e="[0-9a]":e="[0-9a-"+String.fromCharCode(86+t)+"]";var a=new RegExp("^[\\+\\-]?"+e+"+$","i");return function(o){if(a.test(o)){var i=parseInt(o,t);return(i|0)===i?n(i):r}else return r}}}},Pi=function(n){return function(r){return r.toString(n)}};var Oe=function(n){return function(r){return Math.pow(n,r)|0}};var Oi=isFinite;var $i=Math.abs;var wl=Math.atan;var uu=Math.cos;var Ll=Math.log;var $e=function(n){return function(r){return Math.pow(n,r)}},iu=function(n){return function(r){return n%r}},Il=Math.round;var Ka=Math.sin,qi=Math.sqrt;var Ui=6.283185307179586;var Xa=3.141592653589793;var pv=qt(Di),_v=ce(Di);var xl=16,mv=function(){return sv(v.create)(D.value)}(),vv=mv(10),dv=function(){return lv(v.create)(D.value)}(),b0=function(n){if(!Oi(n))return 0;if(n>=On(pv))return pv;if(n<=On(_v))return _v;if(Sn)return Un(0)(dv(n));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[n.constructor.name])},zt=function(n){return b0(Il(n))};var T0=typeof Array.from=="function",HW=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",RW=typeof String.prototype.fromCodePoint=="function",C0=typeof String.prototype.codePointAt=="function",Dv=function(n){return C0?function(r){return r.codePointAt(0)}:n};var gv=function(n){return function(r){return T0?function(t){return Array.from(t,r)}:n}};function qe(n){return n.charCodeAt(0)}function yv(n){return String.fromCharCode(n)}var bv=ce(Uo),Tv=qt(Uo);var Cv=function(n){return n.fromEnum};var ya=function(n){return function(r){return function(t){return n(r(t)+1|0)}}},ha=function(n){return function(r){return function(t){return n(r(t)-1|0)}}};var Al=function(n){return n>=qe(bv)&&n<=qe(Tv)?new v(yv(n)):D.value},L0={succ:ya(Al)(qe),pred:ha(Al)(qe),Ord0:function(){return mi}};var Ev=function(){return{cardinality:qe(Tv)-qe(bv)|0,toEnum:Al,fromEnum:qe,Bounded0:function(){return Uo},Enum1:function(){return L0}}}();var fu=function(n){return n.length};var cu=function(n){return function(r){return r.substring(n)}};var Ue=function(n){return function(r){if(n>=0&&n<r.length)return r.charAt(n);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}};var su=Cv(Ev),W0=g(xn),P0=Bt(eu);var wv=function(n){return function(r){return(((n-55296|0)*1024|0)+(r-56320|0)|0)+65536|0}};var Lv=function(n){return 56320<=n&&n<=57343},Iv=function(n){return 55296<=n&&n<=56319},O0=function(n){var r=fu(n);if(r===0)return D.value;if(r===1)return new v({head:su(Ue(0)(n)),tail:""});var t=su(Ue(1)(n)),e=su(Ue(0)(n)),a=Iv(e)&&Lv(t);return a?new v({head:wv(e)(t),tail:cu(2)(n)}):new v({head:e,tail:cu(1)(n)})},$0=function(n){return W0(function(r){return new I(r.head,r.tail)})(O0(n))},q0=function(n){return P0($0)(n)},U0=function(n){var r=su(Ue(0)(n)),t=Iv(r)&&fu(n)>1;if(t){var e=su(Ue(1)(n)),a=Lv(e);return a?wv(r)(e):r}return r},B0=Dv(U0),k0=gv(q0)(B0),xv=function(n){return ot(k0(n))};var Sl=rm(qo);var j0=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}(),K0=function(n){return function(r){return iu(iu(n)(r)+r)(r)}};var Hl=function(n){return function(r){return function(t){return function(e){var a=Sl(0)(1)(r),o=Sl(0)(1)(t),i=Sl(0)(1)(e);return new j0(n,a,o,i)}}}},X0=function(n){return function(r){return function(t){return function(e){var o=r;if(t===0)return Hl(n)(o/(2-o))(0)(e);if(r===0&&t===1)return Hl(n)(0)(1)(e);var a=(2-r)*t,o=r*t/function(){var c=a<1;return c?a:2-a}(),i=a/2;return Hl(n)(o)(i)(e)}}}},Nv=function(n){return function(r){return function(t){return X0(n)(r)(t)(1)}}};var Y0=function(n){var r=n===360;return r?n:K0(n)(360)};var Z0=function(n){var r=Y0(n.value0)/60,t=(1-$i(2*n.value2-1))*n.value1,e=n.value2-t/2,a=t*(1-$i(iu(r)(2)-1)),o=function(){if(r<1)return{r:t,g:a,b:0};if(1<=r&&r<2)return{r:a,g:t,b:0};if(2<=r&&r<3)return{r:0,g:t,b:a};if(3<=r&&r<4)return{r:0,g:a,b:t};if(4<=r&&r<5)return{r:a,g:0,b:t};if(Sn)return{r:t,g:0,b:a};throw new Error("Failed pattern match at Color (line 356, column 3 - line 362, column 43): "+[])}();return{r:o.r+e,g:o.g+e,b:o.b+e,a:n.value3}};var nE=function(n){var r=Z0(n),t=zt(255*r.g),e=zt(255*r.r),a=zt(255*r.b);return{r:e,g:t,b:a,a:r.a}};var Sv=function(n){var r=function(a){var o=Pi(xl)(a),i=xv(o)===1;return i?"0"+o:o},t=nE(n),e=function(){if(t.a===1)return"";if(Sn)return r(zt(255*t.a));throw new Error("Failed pattern match at Color (line 429, column 3 - line 431, column 46): "+[])}();return"#"+(r(t.r)+(r(t.g)+(r(t.b)+e)))};var At=function(n){return n.ask};var tE=X(Y),eE=B(wn);var Hv=1,aE=function(n){var r=n.MonadAsk0(),t=r.Monad0(),e=T(t.Applicative0()),a=x(t.Bind1()),o=At(r);return function(i){if(i instanceof D)return e(1);if(i instanceof v)return a(o)(function(c){return e(On(i.value0)/On(c))});throw new Error("Failed pattern match at Component.Animation (line 29, column 1 - line 29, column 74): "+[i.constructor.name])}},zi=function(n){var r=n.MonadAsk0().Monad0(),t=x(r.Bind1()),e=aE(n),a=T(r.Applicative0());return function(o){return function(i){return t(e(i))(function(c){return a(function(f){return function(l){return(f-l)*o(c)+l}})})}}},Rv=function(n){return zi(n)(tE)},Wv=function(n){return zi(n)(function(){var r=fn($e)(2);return function(t){return r(Ka(function(e){return Xa*e-Xa/4}(t)))}}())},Pv=function(n){var r=function(a){return(a+1)*.5},t=function(a){return a*2-1},e=function(a){var o=a>=0;return o?$e(a)(.5):-1*$e(-a)(.5)};return zi(n)(function(a){return r(e(t(a)))})},oE={eq:function(n){return function(r){return n===r}}},Rl={compare:function(n){return function(r){return eE(n)(r)}},Eq0:function(){return oE}};var Ov=function(n){return zi(n)($(0))},uE=function(n){var r=n.MonadAsk0(),t=r.Monad0(),e=x(t.Bind1()),a=At(r),o=T(t.Applicative0());return function(i){return e(a)(function(c){return o(i>=c)})}},$v=function(n){var r=n.MonadAsk0().Monad0(),t=x(r.Bind1()),e=uE(n),a=T(r.Applicative0());return function(o){return t(e(o))(function(i){if(i)return a(D.value);if(!i)return a(new v(o+1|0));throw new Error("Failed pattern match at Component.Animation (line 20, column 3 - line 22, column 40): "+[i.constructor.name])})}};var F=function(){function n(){}return n.value=new n,n}(),M=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Pl=function(n){return n};var gE=function(n){var r=function(t){return function(e){var a=t,o=!1,i;function c(f,l){if(l instanceof M&&l.value1 instanceof M&&l.value1.value1 instanceof M){a=new M(l,f),e=l.value1.value1.value1;return}var s=function(d){return d instanceof M&&d.value1 instanceof M&&d.value1.value1 instanceof F?new M(n(d.value0),new M(n(d.value1.value0),F.value)):d instanceof M&&d.value1 instanceof F?new M(n(d.value0),F.value):F.value},m=function(d){return function(p){var u=d,_=!1,H;function pn(Dn,In){if(Dn instanceof M&&Dn.value0 instanceof M&&Dn.value0.value1 instanceof M&&Dn.value0.value1.value1 instanceof M){u=Dn.value1,p=new M(n(Dn.value0.value0),new M(n(Dn.value0.value1.value0),new M(n(Dn.value0.value1.value1.value0),In)));return}return _=!0,In}for(;!_;)H=pn(u,p);return H}};return o=!0,m(f)(s(l))}for(;!o;)i=c(a,e);return i}};return r(F.value)},Nt={map:gE},yE=g(Nt);var Zn={foldr:function(n){return function(r){var t=function(){var a=function(o){return function(i){var c=o,f=!1,l;function s(m,d){if(d instanceof F)return f=!0,m;if(d instanceof M){c=new M(d.value0,m),i=d.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[m.constructor.name,d.constructor.name])}for(;!f;)l=s(c,i);return l}};return a(F.value)}(),e=Tn(Zn)(fn(n))(r);return function(a){return e(t(a))}}},foldl:function(n){var r=function(t){return function(e){var a=t,o=!1,i;function c(f,l){if(l instanceof F)return o=!0,f;if(l instanceof M){a=n(f)(l.value0),e=l.value1;return}throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[l.constructor.name])}for(;!o;)i=c(a,e);return i}};return r},foldMap:function(n){var r=q(n.Semigroup0()),t=En(n);return function(e){return Tn(Zn)(function(a){var o=r(a);return function(i){return o(e(i))}})(t)}}},Wl=Tn(Zn),hE=Bn(Zn);var Uv={foldrWithIndex:function(n){return function(r){return function(t){var e=function(){var a=Wl(function(o){return function(i){return new I(o.value0+1|0,new M(i,o.value1))}});return a(new I(0,F.value))(t)}();return Kn(Wl(function(a){return function(o){return new I(a.value0-1|0,n(a.value0-1|0)(o)(a.value1))}})(new I(e.value0,r))(e.value1))}}},foldlWithIndex:function(n){return function(r){var t=Wl(function(e){return function(a){return new I(e.value0+1|0,n(e.value0)(e.value1)(a))}})(new I(0,r));return function(e){return Kn(t(e))}}},foldMapWithIndex:function(n){var r=q(n.Semigroup0()),t=En(n);return function(e){return ou(Uv)(function(a){return function(o){var i=r(o),c=e(a);return function(f){return i(c(f))}}})(t)}},Foldable0:function(){return Zn}};var bE=Ga(Uv);var Bv={mapWithIndex:function(n){return bE(function(r){return function(t){return function(e){return new M(n(r)(t),e)}}})(F.value)},Functor0:function(){return Nt}};var Be={append:function(n){return function(r){return hE(M.create)(r)(n)}}},Ol=q(Be);var $l={apply:function(n){return function(r){if(n instanceof F)return F.value;if(n instanceof M)return Ol(yE(n.value0)(r))(Cn($l)(n.value1)(r));throw new Error("Failed pattern match at Data.List.Types (line 157, column 1 - line 159, column 48): "+[n.constructor.name,r.constructor.name])}},Functor0:function(){return Nt}};var Ta={bind:function(n){return function(r){if(n instanceof F)return F.value;if(n instanceof M)return Ol(r(n.value0))(x(Ta)(n.value1)(r));throw new Error("Failed pattern match at Data.List.Types (line 164, column 1 - line 166, column 37): "+[n.constructor.name,r.constructor.name])}},Apply0:function(){return $l}};var Vi={pure:function(n){return new M(n,F.value)},Apply0:function(){return $l}};var kv={alt:Ol,Functor0:function(){return Nt}},ql=function(){return{empty:F.value,Alt0:function(){return kv}}}();var wE=Tn(Zn);var LE=x(Ta),IE=X(Y);var Qt=function(n){return new M(n,F.value)};var Gt=function(){var n=function(r){return function(t){var e=r,a=!1,o;function i(c,f){if(f instanceof F)return a=!0,c;if(f instanceof M){e=new M(f.value0,c),t=f.value1;return}throw new Error("Failed pattern match at Data.List (line 368, column 3 - line 368, column 19): "+[c.constructor.name,f.constructor.name])}for(;!a;)o=i(e,t);return o}};return n(F.value)}();var Ji=function(n){return function(r){if(n===r)return Qt(n);if(Sn){var t=function(e){return function(a){return function(o){return function(i){var c=e,f=a,l=o,s=!1,m;function d(p,u,_,H){if(p===u)return s=!0,new M(p,H);if(Sn){c=p+_|0,f=u,l=_,i=new M(p,H);return}throw new Error("Failed pattern match at Data.List (line 148, column 3 - line 149, column 65): "+[p.constructor.name,u.constructor.name,_.constructor.name,H.constructor.name])}for(;!s;)m=d(c,f,l,i);return m}}}};return t(r)(n)(function(){var e=n>r;return e?1:-1}())(F.value)}throw new Error("Failed pattern match at Data.List (line 144, column 1 - line 144, column 32): "+[n.constructor.name,r.constructor.name])}};var Gv=function(n){return n instanceof F};var Ya=wE(function(n){return function(r){return n+1|0}})(0);var Ca=function(n){return Bn(n)(M.create)(F.value)};var Qi=function(n){var r=function(t){return function(e){var a=t,o=!1,i;function c(f,l){if(l instanceof F)return o=!0,Gt(f);if(l instanceof M){if(n(l.value0)){a=new M(l.value0,f),e=l.value1;return}if(Sn){a=f,e=l.value1;return}}throw new Error("Failed pattern match at Data.List (line 390, column 3 - line 390, column 27): "+[f.constructor.name,l.constructor.name])}for(;!o;)i=c(a,e);return i}};return r(F.value)};var jv=function(n){return LE(n)(IE)};var Ul=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var Ea=function(n){var r=zo(n.Eq0()),t=nm(n),e=di(n);return function(a){var o=r(a),i=it(a),c=a.CommutativeRing0().Ring0(),f=Xr(c.Semiring0()),l=t(c),s=e(c);return function(m){return function(d){var p=o(m)(d),u=i(d)(p);return new Ul(f(i(m)(p))(l(u)),s(u))}}}},Kv=function(n){var r=Ea(n);return function(t){var e=t.CommutativeRing0().Ring0().Semiring0(),a=mt(e),o=r(t),i=Xr(e),c=ut(e);return{one:new Ul(a,a),mul:function(f){return function(l){return o(i(f.value0)(l.value0))(i(f.value1)(l.value1))}},zero:new Ul(Nr(e),a),add:function(f){return function(l){return o(c(i(f.value0)(l.value1))(i(f.value1)(l.value0)))(i(f.value1)(l.value1))}}}}},xE=function(n){var r=Ea(n),t=Kv(n);return function(e){var a=r(e),o=e.CommutativeRing0().Ring0(),i=qa(o),c=Xr(o.Semiring0()),f=t(e);return{sub:function(l){return function(s){return a(i(c(l.value0)(s.value1))(c(l.value1)(s.value0)))(c(l.value1)(s.value1))}},Semiring0:function(){return f}}}},Bl=function(n){return n.value0};var kl=function(n){return n.value1},AE=function(n){var r=xE(n);return function(t){var e=r(t);return{Ring0:function(){return e}}}},Xv=function(n){var r=Ea(n),t=Kv(n),e=AE(n);return function(a){var o=r(a),i=Xr(a.CommutativeRing0().Ring0().Semiring0()),c=Nr(t(a)),f=e(a);return{degree:function(l){return 1},div:function(l){return function(s){return o(i(l.value0)(s.value1))(i(l.value1)(s.value0))}},mod:function(l){return function(s){return c}},CommutativeRing0:function(){return f}}}};var NE=Ea(wn)(Fr),Yv=function(n){return On(Bl(n))/On(kl(n))},pu=function(n){return NE(n)(1)};var SE=di(wn)(si),HE=dt(Fr),RE=it(Fr),WE=Ea(wn)(Fr),jt=function(){function n(){}return n.value=new n,n}(),Ht=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),nd=function(n){return function(r){if(r===0)return pu(0);if(n instanceof jt)return pu(SE(r));if(n instanceof Ht){var t=function(e){if(HE(e)(n.value0)===0)return 1+t(RE(e)(n.value0))|0;if(Sn)return 0;throw new Error("Failed pattern match at Norm (line 24, column 9 - line 26, column 26): "+[e.constructor.name])};return WE(1)(Oe(n.value0)(t(r)))}throw new Error("Failed pattern match at Norm (line 20, column 1 - line 20, column 36): "+[n.constructor.name,r.constructor.name])}},rd=function(n){if(n instanceof jt)return!1;if(n instanceof Ht)return!0;throw new Error("Failed pattern match at Norm (line 16, column 1 - line 16, column 27): "+[n.constructor.name])},_u=function(n){if(n instanceof jt)return D.value;if(n instanceof Ht)return new v(n.value0);throw new Error("Failed pattern match at Norm (line 12, column 1 - line 12, column 30): "+[n.constructor.name])};var Kt=function(n){var r=null;return function(){return n===void 0||(r=n(),n=void 0),r}},Za=function(n){return n()};var Gi={map:function(n){return function(r){return Kt(function(t){return n(Za(r))})}}};var OE=gr();var Ql=function(n){return n},no=function(){function n(){}return n.value=new n,n}(),ro=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var ji=Kt(function(n){return no.value});var Ki=function(n){return Za(OE(n))};var td={defer:function(n){return Kt(function(r){return Ki(n(r))})}};var Xi=function(n){return function(r){return Kt(function(t){return new ro(n,r)})}},Ma={foldr:function(n){return function(r){return function(t){var e=Tn(Ma)(fn(Xi))(ji);return Tn(Ma)(fn(n))(r)(e(t))}}},foldl:function(n){var r=function(t){return function(e){var a=t,o=!1,i;function c(f,l){var s=Ki(l);if(s instanceof no)return o=!0,f;if(s instanceof ro){a=n(f)(s.value0),e=s.value1;return}throw new Error("Failed pattern match at Data.List.Lazy.Types (line 127, column 7 - line 129, column 40): "+[s.constructor.name])}for(;!o;)i=c(a,e);return i}};return r},foldMap:function(n){var r=q(n.Semigroup0()),t=En(n);return function(e){return Tn(Ma)(function(a){return function(o){return r(a)(e(o))}})(t)}}};var UE=g(Gi),BE=gr();var kE=N_(td);var ed=function(n){var r=function(a){return function(o){if(o instanceof no)return no.value;if(o instanceof ro)return new ro(o.value0,ed(a-1|0)(o.value1));throw new Error("Failed pattern match at Data.List.Lazy (line 505, column 3 - line 505, column 32): "+[a.constructor.name,o.constructor.name])}},t=n<=0;if(t)return $(ji);var e=UE(r(n));return function(a){return Ql(e(BE(a)))}};var zE=function(n){return kE(function(r){return Xi(n)(r)})},ad=function(n){return function(r){return ed(n)(zE(r))}};var ud=function(n){return n()};var id=function(n){throw new Error(n)};var fd=function(){return id};var GE=fd(),jE=ud,ke=function(n){return jE(function(){return GE(n)})};var k=function(){function n(){}return n.value=new n,n}(),rn=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}(),Mn=function(){function n(r,t,e,a,o,i,c){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=o,this.value5=i,this.value6=c}return n.create=function(r){return function(t){return function(e){return function(a){return function(o){return function(i){return function(c){return new n(r,t,e,a,o,i,c)}}}}}}},n}(),ze=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),ge=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),Ve=function(){function n(r,t,e,a,o,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=o,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(o){return function(i){return new n(r,t,e,a,o,i)}}}}}},n}(),Xt=function(){function n(r,t,e,a,o,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=o,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(o){return function(i){return new n(r,t,e,a,o,i)}}}}}},n}(),Je=function(){function n(r,t,e,a,o,i){this.value0=r,this.value1=t,this.value2=e,this.value3=a,this.value4=o,this.value5=i}return n.create=function(r){return function(t){return function(e){return function(a){return function(o){return function(i){return new n(r,t,e,a,o,i)}}}}}},n}(),Yi=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}();var Kl=function(n){return function(r){return new rn(k.value,n,r,k.value)}};var ht=function(n){var r=B(n);return function(t){var e=function(a){var o=!1,i;function c(f){if(f instanceof k)return o=!0,D.value;if(f instanceof rn){var l=r(t)(f.value1);if(l instanceof N)return o=!0,new v(f.value2);if(l instanceof L){a=f.value0;return}a=f.value3;return}if(f instanceof Mn){var s=r(t)(f.value1);if(s instanceof N)return o=!0,new v(f.value2);var m=r(t)(f.value4);if(m instanceof N)return o=!0,new v(f.value5);if(s instanceof L){a=f.value0;return}if(m instanceof A){a=f.value6;return}a=f.value3;return}throw new Error("Failed pattern match at Data.Map.Internal (line 241, column 5 - line 241, column 22): "+[f.constructor.name])}for(;!o;)i=c(a);return i};return e}},ld=function(n){var r=ht(n);return function(t){return function(e){return Ba(r(t)(e))}}};var sd=function(n){return function(r){return function(t){var e=n,a=r,o=!1,i;function c(f,l,s){if(l instanceof F)return o=!0,s;if(l instanceof M){if(l.value0 instanceof ze){e=f,a=l.value1,t=new rn(s,l.value0.value0,l.value0.value1,l.value0.value2);return}if(l.value0 instanceof ge){e=f,a=l.value1,t=new rn(l.value0.value0,l.value0.value1,l.value0.value2,s);return}if(l.value0 instanceof Ve){e=f,a=l.value1,t=new Mn(s,l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5);return}if(l.value0 instanceof Xt){e=f,a=l.value1,t=new Mn(l.value0.value0,l.value0.value1,l.value0.value2,s,l.value0.value3,l.value0.value4,l.value0.value5);return}if(l.value0 instanceof Je){e=f,a=l.value1,t=new Mn(l.value0.value0,l.value0.value1,l.value0.value2,l.value0.value3,l.value0.value4,l.value0.value5,s);return}throw new Error("Failed pattern match at Data.Map.Internal (line 462, column 3 - line 467, column 88): "+[l.value0.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 459, column 1 - line 459, column 80): "+[l.constructor.name,s.constructor.name])}for(;!o;)i=c(e,a,t);return i}}},Zr=function(n){var r=sd(n),t=B(n);return function(e){return function(a){var o=function(c){return function(f){var l=c,s=!1,m;function d(p,u){if(p instanceof F)return s=!0,new rn(u.value0,u.value1,u.value2,u.value3);if(p instanceof M){if(p.value0 instanceof ze)return s=!0,r(p.value1)(new Mn(u.value0,u.value1,u.value2,u.value3,p.value0.value0,p.value0.value1,p.value0.value2));if(p.value0 instanceof ge)return s=!0,r(p.value1)(new Mn(p.value0.value0,p.value0.value1,p.value0.value2,u.value0,u.value1,u.value2,u.value3));if(p.value0 instanceof Ve){l=p.value1,f=new Yi(new rn(u.value0,u.value1,u.value2,u.value3),p.value0.value0,p.value0.value1,new rn(p.value0.value2,p.value0.value3,p.value0.value4,p.value0.value5));return}if(p.value0 instanceof Xt){l=p.value1,f=new Yi(new rn(p.value0.value0,p.value0.value1,p.value0.value2,u.value0),u.value1,u.value2,new rn(u.value3,p.value0.value3,p.value0.value4,p.value0.value5));return}if(p.value0 instanceof Je){l=p.value1,f=new Yi(new rn(p.value0.value0,p.value0.value1,p.value0.value2,p.value0.value3),p.value0.value4,p.value0.value5,new rn(u.value0,u.value1,u.value2,u.value3));return}throw new Error("Failed pattern match at Data.Map.Internal (line 498, column 5 - line 503, column 108): "+[p.value0.constructor.name,u.constructor.name])}throw new Error("Failed pattern match at Data.Map.Internal (line 495, column 3 - line 495, column 56): "+[p.constructor.name,u.constructor.name])}for(;!s;)m=d(l,f);return m}},i=function(c){return function(f){var l=c,s=!1,m;function d(p,u){if(u instanceof k)return s=!0,o(p)(new Yi(k.value,e,a,k.value));if(u instanceof rn){var _=t(e)(u.value1);if(_ instanceof N)return s=!0,r(p)(new rn(u.value0,e,a,u.value3));if(_ instanceof L){l=new M(new ze(u.value1,u.value2,u.value3),p),f=u.value0;return}l=new M(new ge(u.value0,u.value1,u.value2),p),f=u.value3;return}if(u instanceof Mn){var _=t(e)(u.value1);if(_ instanceof N)return s=!0,r(p)(new Mn(u.value0,e,a,u.value3,u.value4,u.value5,u.value6));var H=t(e)(u.value4);if(H instanceof N)return s=!0,r(p)(new Mn(u.value0,u.value1,u.value2,u.value3,e,a,u.value6));if(_ instanceof L){l=new M(new Ve(u.value1,u.value2,u.value3,u.value4,u.value5,u.value6),p),f=u.value0;return}if(_ instanceof A&&H instanceof L){l=new M(new Xt(u.value0,u.value1,u.value2,u.value4,u.value5,u.value6),p),f=u.value3;return}l=new M(new Je(u.value0,u.value1,u.value2,u.value3,u.value4,u.value5),p),f=u.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 478, column 3 - line 478, column 55): "+[p.constructor.name,u.constructor.name])}for(;!s;)m=d(l,f);return m}};return i(F.value)}}},Xl=function(n){var r=sd(n),t=B(n);return function(e){var a=function(f){return function(l){var s=f,m=!1,d;function p(u,_){if(u instanceof F)return m=!0,_;if(u instanceof M){if(u.value0 instanceof ze&&u.value0.value2 instanceof k&&_ instanceof k)return m=!0,r(u.value1)(new rn(k.value,u.value0.value0,u.value0.value1,k.value));if(u.value0 instanceof ge&&u.value0.value0 instanceof k&&_ instanceof k)return m=!0,r(u.value1)(new rn(k.value,u.value0.value1,u.value0.value2,k.value));if(u.value0 instanceof ze&&u.value0.value2 instanceof rn){s=u.value1,l=new Mn(_,u.value0.value0,u.value0.value1,u.value0.value2.value0,u.value0.value2.value1,u.value0.value2.value2,u.value0.value2.value3);return}if(u.value0 instanceof ge&&u.value0.value0 instanceof rn){s=u.value1,l=new Mn(u.value0.value0.value0,u.value0.value0.value1,u.value0.value0.value2,u.value0.value0.value3,u.value0.value1,u.value0.value2,_);return}return u.value0 instanceof ze&&u.value0.value2 instanceof Mn?(m=!0,r(u.value1)(new rn(new rn(_,u.value0.value0,u.value0.value1,u.value0.value2.value0),u.value0.value2.value1,u.value0.value2.value2,new rn(u.value0.value2.value3,u.value0.value2.value4,u.value0.value2.value5,u.value0.value2.value6)))):u.value0 instanceof ge&&u.value0.value0 instanceof Mn?(m=!0,r(u.value1)(new rn(new rn(u.value0.value0.value0,u.value0.value0.value1,u.value0.value0.value2,u.value0.value0.value3),u.value0.value0.value4,u.value0.value0.value5,new rn(u.value0.value0.value6,u.value0.value1,u.value0.value2,_)))):u.value0 instanceof Ve&&u.value0.value2 instanceof k&&u.value0.value5 instanceof k&&_ instanceof k?(m=!0,r(u.value1)(new Mn(k.value,u.value0.value0,u.value0.value1,k.value,u.value0.value3,u.value0.value4,k.value))):u.value0 instanceof Xt&&u.value0.value0 instanceof k&&u.value0.value5 instanceof k&&_ instanceof k?(m=!0,r(u.value1)(new Mn(k.value,u.value0.value1,u.value0.value2,k.value,u.value0.value3,u.value0.value4,k.value))):u.value0 instanceof Je&&u.value0.value0 instanceof k&&u.value0.value3 instanceof k&&_ instanceof k?(m=!0,r(u.value1)(new Mn(k.value,u.value0.value1,u.value0.value2,k.value,u.value0.value4,u.value0.value5,k.value))):u.value0 instanceof Ve&&u.value0.value2 instanceof rn?(m=!0,r(u.value1)(new rn(new Mn(_,u.value0.value0,u.value0.value1,u.value0.value2.value0,u.value0.value2.value1,u.value0.value2.value2,u.value0.value2.value3),u.value0.value3,u.value0.value4,u.value0.value5))):u.value0 instanceof Xt&&u.value0.value0 instanceof rn?(m=!0,r(u.value1)(new rn(new Mn(u.value0.value0.value0,u.value0.value0.value1,u.value0.value0.value2,u.value0.value0.value3,u.value0.value1,u.value0.value2,_),u.value0.value3,u.value0.value4,u.value0.value5))):u.value0 instanceof Xt&&u.value0.value5 instanceof rn?(m=!0,r(u.value1)(new rn(u.value0.value0,u.value0.value1,u.value0.value2,new Mn(_,u.value0.value3,u.value0.value4,u.value0.value5.value0,u.value0.value5.value1,u.value0.value5.value2,u.value0.value5.value3)))):u.value0 instanceof Je&&u.value0.value3 instanceof rn?(m=!0,r(u.value1)(new rn(u.value0.value0,u.value0.value1,u.value0.value2,new Mn(u.value0.value3.value0,u.value0.value3.value1,u.value0.value3.value2,u.value0.value3.value3,u.value0.value4,u.value0.value5,_)))):u.value0 instanceof Ve&&u.value0.value2 instanceof Mn?(m=!0,r(u.value1)(new Mn(new rn(_,u.value0.value0,u.value0.value1,u.value0.value2.value0),u.value0.value2.value1,u.value0.value2.value2,new rn(u.value0.value2.value3,u.value0.value2.value4,u.value0.value2.value5,u.value0.value2.value6),u.value0.value3,u.value0.value4,u.value0.value5))):u.value0 instanceof Xt&&u.value0.value0 instanceof Mn?(m=!0,r(u.value1)(new Mn(new rn(u.value0.value0.value0,u.value0.value0.value1,u.value0.value0.value2,u.value0.value0.value3),u.value0.value0.value4,u.value0.value0.value5,new rn(u.value0.value0.value6,u.value0.value1,u.value0.value2,_),u.value0.value3,u.value0.value4,u.value0.value5))):u.value0 instanceof Xt&&u.value0.value5 instanceof Mn?(m=!0,r(u.value1)(new Mn(u.value0.value0,u.value0.value1,u.value0.value2,new rn(_,u.value0.value3,u.value0.value4,u.value0.value5.value0),u.value0.value5.value1,u.value0.value5.value2,new rn(u.value0.value5.value3,u.value0.value5.value4,u.value0.value5.value5,u.value0.value5.value6)))):u.value0 instanceof Je&&u.value0.value3 instanceof Mn?(m=!0,r(u.value1)(new Mn(u.value0.value0,u.value0.value1,u.value0.value2,new rn(u.value0.value3.value0,u.value0.value3.value1,u.value0.value3.value2,u.value0.value3.value3),u.value0.value3.value4,u.value0.value3.value5,new rn(u.value0.value3.value6,u.value0.value4,u.value0.value5,_)))):(m=!0,ke("The impossible happened in partial function `up`."))}throw new Error("Failed pattern match at Data.Map.Internal (line 552, column 5 - line 573, column 86): "+[u.constructor.name])}for(;!m;)d=p(s,l);return d}},o=function(f){return function(l){var s=f,m=!1,d;function p(u,_){if(_ instanceof rn&&_.value0 instanceof k&&_.value3 instanceof k)return m=!0,a(u)(k.value);if(_ instanceof rn){s=new M(new ge(_.value0,_.value1,_.value2),u),l=_.value3;return}if(_ instanceof Mn&&_.value0 instanceof k&&_.value3 instanceof k&&_.value6 instanceof k)return m=!0,a(new M(new ge(k.value,_.value1,_.value2),u))(k.value);if(_ instanceof Mn){s=new M(new Je(_.value0,_.value1,_.value2,_.value3,_.value4,_.value5),u),l=_.value6;return}return m=!0,ke("The impossible happened in partial function `removeMaxNode`.")}for(;!m;)d=p(s,l);return d}},i=function(f){var l=!1,s;function m(d){if(d instanceof rn&&d.value3 instanceof k)return l=!0,{key:d.value1,value:d.value2};if(d instanceof rn){f=d.value3;return}if(d instanceof Mn&&d.value6 instanceof k)return l=!0,{key:d.value4,value:d.value5};if(d instanceof Mn){f=d.value6;return}return l=!0,ke("The impossible happened in partial function `maxNode`.")}for(;!l;)s=m(f);return s},c=function(f){return function(l){var s=f,m=!1,d;function p(u,_){if(_ instanceof k)return m=!0,D.value;if(_ instanceof rn){var H=t(e)(_.value1);if(_.value3 instanceof k&&H instanceof N)return m=!0,new v(new I(_.value2,a(u)(k.value)));if(H instanceof N){var pn=i(_.value0);return m=!0,new v(new I(_.value2,o(new M(new ze(pn.key,pn.value,_.value3),u))(_.value0)))}if(H instanceof L){s=new M(new ze(_.value1,_.value2,_.value3),u),l=_.value0;return}s=new M(new ge(_.value0,_.value1,_.value2),u),l=_.value3;return}if(_ instanceof Mn){var Dn=function(){return _.value0 instanceof k&&_.value3 instanceof k&&_.value6 instanceof k}(),H=t(e)(_.value4),In=t(e)(_.value1);if(Dn&&In instanceof N)return m=!0,new v(new I(_.value2,r(u)(new rn(k.value,_.value4,_.value5,k.value))));if(Dn&&H instanceof N)return m=!0,new v(new I(_.value5,r(u)(new rn(k.value,_.value1,_.value2,k.value))));if(In instanceof N){var pn=i(_.value0);return m=!0,new v(new I(_.value2,o(new M(new Ve(pn.key,pn.value,_.value3,_.value4,_.value5,_.value6),u))(_.value0)))}if(H instanceof N){var pn=i(_.value3);return m=!0,new v(new I(_.value5,o(new M(new Xt(_.value0,_.value1,_.value2,pn.key,pn.value,_.value6),u))(_.value3)))}if(In instanceof L){s=new M(new Ve(_.value1,_.value2,_.value3,_.value4,_.value5,_.value6),u),l=_.value0;return}if(In instanceof A&&H instanceof L){s=new M(new Xt(_.value0,_.value1,_.value2,_.value4,_.value5,_.value6),u),l=_.value3;return}s=new M(new Je(_.value0,_.value1,_.value2,_.value3,_.value4,_.value5),u),l=_.value6;return}throw new Error("Failed pattern match at Data.Map.Internal (line 525, column 16 - line 548, column 80): "+[_.constructor.name])}for(;!m;)d=p(s,l);return d}};return c(F.value)}},br={foldr:function(n){return function(r){return function(t){if(t instanceof k)return r;if(t instanceof rn)return Bn(br)(n)(n(t.value2)(Bn(br)(n)(r)(t.value3)))(t.value0);if(t instanceof Mn)return Bn(br)(n)(n(t.value2)(Bn(br)(n)(n(t.value5)(Bn(br)(n)(r)(t.value6)))(t.value3)))(t.value0);throw new Error("Failed pattern match at Data.Map.Internal (line 133, column 17 - line 136, column 85): "+[t.constructor.name])}}},foldl:function(n){return function(r){return function(t){if(t instanceof k)return r;if(t instanceof rn)return Tn(br)(n)(n(Tn(br)(n)(r)(t.value0))(t.value2))(t.value3);if(t instanceof Mn)return Tn(br)(n)(n(Tn(br)(n)(n(Tn(br)(n)(r)(t.value0))(t.value2))(t.value3))(t.value5))(t.value6);throw new Error("Failed pattern match at Data.Map.Internal (line 137, column 17 - line 140, column 85): "+[t.constructor.name])}}},foldMap:function(n){var r=En(n),t=q(n.Semigroup0());return function(e){return function(a){if(a instanceof k)return r;if(a instanceof rn)return t(_r(br)(n)(e)(a.value0))(t(e(a.value2))(_r(br)(n)(e)(a.value3)));if(a instanceof Mn)return t(_r(br)(n)(e)(a.value0))(t(e(a.value2))(t(_r(br)(n)(e)(a.value3))(t(e(a.value5))(_r(br)(n)(e)(a.value6)))));throw new Error("Failed pattern match at Data.Map.Internal (line 141, column 17 - line 144, column 93): "+[a.constructor.name])}}}};var wr=function(){return k.value}(),pd=function(n){var r=Zr(n);return function(t){return Tn(t)(function(e){return function(a){return r(a.value0)(a.value1)(e)}})(wr)}};var Zi=function(n){var r=Xl(n);return function(t){return function(e){return Hn(e)(Kn)(r(t)(e))}}};var to=function(n){var r=ht(n),t=Zi(n),e=Zr(n);return function(a){return function(o){return function(i){var c=a(r(o)(i));if(c instanceof D)return t(o)(i);if(c instanceof v)return e(o)(c.value0)(i);throw new Error("Failed pattern match at Data.Map.Internal (line 596, column 15 - line 598, column 25): "+[c.constructor.name])}}}},_d=function(n){var r=to(n);return function(t){var e=Tn(t);return function(a){var o=function(i){return function(c){if(c instanceof v)return new v(a(i)(c.value0));if(c instanceof D)return new v(i);throw new Error("Failed pattern match at Data.Map.Internal (line 613, column 3 - line 613, column 38): "+[i.constructor.name,c.constructor.name])}};return e(function(i){return function(c){return r(o(c.value1))(c.value0)(i)}})(wr)}}};var ye=dt(Fr),Yl=it(Fr),YE=zo(fa)(Fr),Zl=g(Nt),ZE=pd(wn)(Zn),md=_d(wn)(Zn),vd=Ca(yr),nf=x(Ta),dd=T(Vi),nM=function(n){return function(r){if(r===1)return new v(1);var t=function(a){return function(o){return function(i){return function(c){var f=a,l=o,s=i,m=!1,d;function p(u,_,H,pn){if(pn===0)return m=!0,ye(u)(n);var Dn=Yl(H)(pn);f=_,l=u-(Dn*_|0)|0,s=pn,c=H-(Dn*pn|0)|0}for(;!m;)d=p(f,l,s,c);return d}}}},e=YE(n)(r)===1;return e?new v(t(0)(1)(n)(r)):D.value}},Dd=function(n){var r=Ji(0)(n-1|0),t=Zl(function(e){return new I(e,nM(n)(e))})(r);return ZE(t)},rM=function(n){var r=ht(n);return function(t){return function(e){return function(a){return Un(e)(r(t)(a))}}}},rf=rM(wn),gd=function(n){return function(r){return jv(new M(n,new M(r,F.value)))}},tM=function(n){var r=Ji(0)(n-1|0),t=Zl(function(e){return new I(ye((e*e|0)*e|0)(n),Qt(e))})(r);return md(gd)(t)},yd=function(n){return function(r){return function(t){if(t===0)return new M(0,F.value);var e=tM(n),a=Dd(n),o=function(f){return function(l){return function(s){return function(m){var d=f,p=l,u=s,_=!1,H;function pn(Dn,In,tn,S){if(In>=r)return _=!0,tn;if(Sn){var Jn=Yl(((tn*tn|0)*tn|0)-t|0)(Dn),Ct=ye(Jn*(n-S|0)|0)(n);d=n*Dn|0,p=In+1|0,u=tn+(Ct*Dn|0)|0,m=S;return}throw new Error("Failed pattern match at Roots (line 85, column 5 - line 85, column 42): "+[Dn.constructor.name,In.constructor.name,tn.constructor.name,S.constructor.name])}for(;!_;)H=pn(d,p,u,m);return H}}}},i=function(f){return rf(ye(f)(n))(F.value)(e)},c=function(f){return vd(rf(ye(f)(n))(D.value)(a))};return nf(i(t))(function(f){return nf(c((3*f|0)*f|0))(function(l){return dd(o(n)(1)(f)(l))})})}}},eM=function(n){var r=Ji(0)(n-1|0),t=Zl(function(e){return new I(ye(e*e|0)(n),Qt(e))})(r);return md(gd)(t)},hd=function(n){return function(r){return function(t){if(t===0)return new M(0,F.value);var e=eM(n),a=Dd(n),o=function(f){return function(l){return function(s){return function(m){var d=f,p=l,u=s,_=!1,H;function pn(Dn,In,tn,S){if(In>=r)return _=!0,tn;if(Sn){var Jn=Yl((tn*tn|0)-t|0)(Dn),Ct=ye(Jn*(n-S|0)|0)(n);d=n*Dn|0,p=In+1|0,u=tn+(Ct*Dn|0)|0,m=S;return}throw new Error("Failed pattern match at Roots (line 61, column 5 - line 61, column 42): "+[Dn.constructor.name,In.constructor.name,tn.constructor.name,S.constructor.name])}for(;!_;)H=pn(d,p,u,m);return H}}}},i=function(f){return rf(ye(f)(n))(F.value)(e)},c=function(f){return vd(rf(ye(f)(n))(D.value)(a))};return nf(i(t))(function(f){return nf(c(2*f|0))(function(l){return dd(o(n)(1)(f)(l))})})}}};var bd=function(n){return function(r){if(n instanceof jt)return function(t){return Qt(zt(qi(On(t))))};if(n instanceof Ht)return hd(n.value0)(r);throw new Error("Failed pattern match at Component.Bubble (line 15, column 1 - line 15, column 45): "+[n.constructor.name,r.constructor.name])}},Td=function(n){return function(r){if(n instanceof jt){var t=fn($e)(.3333333333333333);return function(e){return Qt(zt(t(On(e))))}}if(n instanceof Ht)return yd(n.value0)(r);throw new Error("Failed pattern match at Component.Bubble (line 19, column 1 - line 19, column 45): "+[n.constructor.name,r.constructor.name])}},Cd=function(n){return function(r){return function(t){return function(e){return function(a){return(((((a*a|0)*a|0)*n|0)+((a*a|0)*r|0)|0)+(a*t|0)|0)+e|0}}}}};function bt(n){return new Error(n)}function he(n){return function(){throw n}}var Md=function(n){return he(bt(n))};var Qr=function(n){return n.throwError};var Zt=function(n){return n.catchError};var ns=function(n){var r=Zt(n),t=n.MonadThrow0().Monad0(),e=g(t.Bind1().Apply0().Functor0()),a=T(t.Applicative0());return function(o){return r(e(yn.create)(o))(function(i){return a(gn.create(i))})}};var be=function(n){return n.state};var vu=function(n){var r=be(n);return function(t){return r(function(e){return new I(void 0,t(e))})}},du=function(n){var r=be(n);return function(t){return r(function(e){var a=t(e);return new I(a,a)})}};var Du=function(n){return be(n)(function(r){return new I(r,r)})};var Fd={liftEffect:X(Y),Monad0:function(){return me}},zn=function(n){return n.liftEffect};var Id=function(n){return n},rs=function(n){return function(r){return function(t){return r(n(t))}}};var of=function(n){return function(r){return function(t){return n(r(t))}}},lM=function(n){return{map:function(){var r=g(n);return function(t){return of(r(t))}}()}};var xd=function(n){var r=Cn(n),t=lM(n.Functor0());return{apply:function(e){return function(a){return function(o){return r(e(o))(a(o))}}},Functor0:function(){return t}}},sM=function(n){var r=x(n),t=xd(n.Apply0());return{bind:function(e){return function(a){return function(o){return r(e(o))(function(i){var c=a(i);return c(o)})}}},Apply0:function(){return t}}};var Ad=function(n){var r=xd(n.Apply0());return{pure:function(){var t=T(n);return function(e){return Id($(t(e)))}}(),Apply0:function(){return r}}},ts=function(n){var r=Ad(n.Applicative0()),t=sM(n.Bind1());return{Applicative0:function(){return r},Bind1:function(){return t}}},pM=function(n){var r=ts(n);return{ask:T(n.Applicative0()),Monad0:function(){return r}}},Nd=function(n){var r=pM(n);return{local:rs,MonadAsk0:function(){return r}}};var mM=gr();var uo=function(n){return function(r){return mM(n(r))}};var es=function(n){return Kl(n)(void 0)};var as=function(n){var r=ld(n);return function(t){return function(e){return r(t)(e)}}};var os=function(n){var r=Zr(n);return function(t){return function(e){return r(t)(void 0)(e)}}};var io=wr;var Lr=function(){var n={},r="Pure",t="Throw",e="Catch",a="Sync",o="Async",i="Bind",c="Bracket",f="Fork",l="Sequential",s="Map",m="Apply",d="Alt",p="Cons",u="Resume",_="Release",H="Finalizer",pn="Finalized",Dn="Forked",In="Fiber",tn="Thunk";function S(O,Ln,ar,Rn){this.tag=O,this._1=Ln,this._2=ar,this._3=Rn}function Jn(O){var Ln=function(ar,Rn,V){return new S(O,ar,Rn,V)};return Ln.tag=O,Ln}function Ct(O){return new S(r,void 0)}function Ic(O){try{O()}catch(Ln){setTimeout(function(){throw Ln},0)}}function xc(O,Ln,ar){try{return Ln(ar())}catch(Rn){return O(Rn)}}function Ac(O,Ln,ar){try{return Ln(ar)()}catch(Rn){return ar(O(Rn))(),Ct}}var Zu=function(){var O=1024,Ln=0,ar=0,Rn=new Array(O),V=!1;function w(){var Nn;for(V=!0;Ln!==0;)Ln--,Nn=Rn[ar],Rn[ar]=void 0,ar=(ar+1)%O,Nn();V=!1}return{isDraining:function(){return V},enqueue:function(Nn){var mn,Xn;Ln===O&&(Xn=V,w(),V=Xn),Rn[(ar+Ln)%O]=Nn,Ln++,V||w()}}}();function Nb(O){var Ln={},ar=0,Rn=0;return{register:function(V){var w=ar++;V.onComplete({rethrow:!0,handler:function(Nn){return function(){Rn--,delete Ln[w]}}})(),Ln[w]=V,Rn++},isEmpty:function(){return Rn===0},killAll:function(V,w){return function(){if(Rn===0)return w();var Nn=0,mn={};function Xn($n){mn[$n]=Ln[$n].kill(V,function(fr){return function(){delete mn[$n],Nn--,O.isLeft(fr)&&O.fromLeft(fr)&&setTimeout(function(){throw O.fromLeft(fr)},0),Nn===0&&w()}})()}for(var Er in Ln)Ln.hasOwnProperty(Er)&&(Nn++,Xn(Er));return Ln={},ar=0,Rn=0,function($n){return new S(a,function(){for(var fr in mn)mn.hasOwnProperty(fr)&&mn[fr]()})}}}}}var Ra=0,jr=1,ni=2,ri=3,ti=4,et=5,Io=6;function Nc(O,Ln,ar){var Rn=0,V=Ra,w=ar,Nn=null,mn=null,Xn=null,Er=null,$n=null,fr=0,ua=0,_t=null,we=!0;function Le(J){for(var G,hn,Fn;;)switch(G=null,hn=null,Fn=null,V){case ni:V=jr;try{w=Xn(w),Er===null?Xn=null:(Xn=Er._1,Er=Er._2)}catch(xr){V=et,Nn=O.left(xr),w=null}break;case ri:O.isLeft(w)?(V=et,Nn=w,w=null):Xn===null?V=et:(V=ni,w=O.fromRight(w));break;case jr:switch(w.tag){case i:Xn&&(Er=new S(p,Xn,Er)),Xn=w._2,V=jr,w=w._1;break;case r:Xn===null?(V=et,w=O.right(w._1)):(V=ni,w=w._1);break;case a:V=ri,w=xc(O.left,O.right,w._1);break;case o:V=ti,w=Ac(O.left,w._1,function(xr){return function(){Rn===J&&(Rn++,Zu.enqueue(function(){Rn===J+1&&(V=ri,w=xr,Le(Rn))}))}});return;case t:V=et,Nn=O.left(w._1),w=null;break;case e:Xn===null?$n=new S(p,w,$n,mn):$n=new S(p,w,new S(p,new S(u,Xn,Er),$n,mn),mn),Xn=null,Er=null,V=jr,w=w._1;break;case c:fr++,Xn===null?$n=new S(p,w,$n,mn):$n=new S(p,w,new S(p,new S(u,Xn,Er),$n,mn),mn),Xn=null,Er=null,V=jr,w=w._1;break;case f:V=ri,G=Nc(O,Ln,w._2),Ln&&Ln.register(G),w._1&&G.run(),w=O.right(G);break;case l:V=jr,w=Hb(O,Ln,w._1);break}break;case et:if(Xn=null,Er=null,$n===null)V=Io,w=mn||Nn||w;else switch(G=$n._3,Fn=$n._1,$n=$n._2,Fn.tag){case e:mn&&mn!==G&&fr===0?V=et:Nn&&(V=jr,w=Fn._2(O.fromLeft(Nn)),Nn=null);break;case u:mn&&mn!==G&&fr===0||Nn?V=et:(Xn=Fn._1,Er=Fn._2,V=ni,w=O.fromRight(w));break;case c:fr--,Nn===null&&(hn=O.fromRight(w),$n=new S(p,new S(_,Fn._2,hn),$n,G),(mn===G||fr>0)&&(V=jr,w=Fn._3(hn)));break;case _:$n=new S(p,new S(pn,w,Nn),$n,mn),V=jr,mn&&mn!==G&&fr===0?w=Fn._1.killed(O.fromLeft(mn))(Fn._2):Nn?w=Fn._1.failed(O.fromLeft(Nn))(Fn._2):w=Fn._1.completed(O.fromRight(w))(Fn._2),Nn=null,fr++;break;case H:fr++,$n=new S(p,new S(pn,w,Nn),$n,mn),V=jr,w=Fn._1;break;case pn:fr--,V=et,w=Fn._1,Nn=Fn._2;break}break;case Io:for(var ur in _t)_t.hasOwnProperty(ur)&&(we=we&&_t[ur].rethrow,Ic(_t[ur].handler(w)));_t=null,mn&&Nn?setTimeout(function(){throw O.fromLeft(Nn)},0):O.isLeft(w)&&we&&setTimeout(function(){if(we)throw O.fromLeft(w)},0);return;case Ra:V=jr;break;case ti:return}}function or(J){return function(){if(V===Io)return we=we&&J.rethrow,J.handler(w)(),function(){};var G=ua++;return _t=_t||{},_t[G]=J,function(){_t!==null&&delete _t[G]}}}function K(J,G){return function(){if(V===Io)return G(O.right(void 0))(),function(){};var hn=or({rethrow:!1,handler:function(){return G(O.right(void 0))}})();switch(V){case Ra:mn=O.left(J),V=Io,w=mn,Le(Rn);break;case ti:mn===null&&(mn=O.left(J)),fr===0&&(V===ti&&($n=new S(p,new S(H,w(J)),$n,mn)),V=et,w=null,Nn=null,Le(++Rn));break;default:mn===null&&(mn=O.left(J)),fr===0&&(V=et,w=null,Nn=null)}return hn}}function vn(J){return function(){var G=or({rethrow:!1,handler:J})();return V===Ra&&Le(Rn),G}}return{kill:K,join:vn,onComplete:or,isSuspended:function(){return V===Ra},run:function(){V===Ra&&(Zu.isDraining()?Le(Rn):Zu.enqueue(function(){Le(Rn)}))}}}function Sb(O,Ln,ar,Rn){var V=0,w={},Nn=0,mn={},Xn=new Error("[ParAff] Early exit"),Er=null,$n=n;function fr(or,K,vn){var J=K,G=null,hn=null,Fn=0,ur={},xr,xo;n:for(;;)switch(xr=null,J.tag){case Dn:if(J._3===n&&(xr=w[J._1],ur[Fn++]=xr.kill(or,function(Rb){return function(){Fn--,Fn===0&&vn(Rb)()}})),G===null)break n;J=G._2,hn===null?G=null:(G=hn._1,hn=hn._2);break;case s:J=J._2;break;case m:case d:G&&(hn=new S(p,G,hn)),G=J,J=J._1;break}if(Fn===0)vn(O.right(void 0))();else for(xo=0,xr=Fn;xo<xr;xo++)ur[xo]=ur[xo]();return ur}function ua(or,K,vn){var J,G,hn,Fn,ur,xr;O.isLeft(or)?(J=or,G=null):(G=or,J=null);n:for(;;){if(hn=null,Fn=null,ur=null,xr=null,Er!==null)return;if(K===null){Rn(J||G)();return}if(K._3!==n)return;switch(K.tag){case s:J===null?(K._3=O.right(K._1(O.fromRight(G))),G=K._3):K._3=J;break;case m:if(hn=K._1._3,Fn=K._2._3,J){if(K._3=J,ur=!0,xr=Nn++,mn[xr]=fr(Xn,J===hn?K._2:K._1,function(){return function(){delete mn[xr],ur?ur=!1:vn===null?ua(J,null,null):ua(J,vn._1,vn._2)}}),ur){ur=!1;return}}else{if(hn===n||Fn===n)return;G=O.right(O.fromRight(hn)(O.fromRight(Fn))),K._3=G}break;case d:if(hn=K._1._3,Fn=K._2._3,hn===n&&O.isLeft(Fn)||Fn===n&&O.isLeft(hn))return;if(hn!==n&&O.isLeft(hn)&&Fn!==n&&O.isLeft(Fn))J=G===hn?Fn:hn,G=null,K._3=J;else if(K._3=G,ur=!0,xr=Nn++,mn[xr]=fr(Xn,G===hn?K._2:K._1,function(){return function(){delete mn[xr],ur?ur=!1:vn===null?ua(G,null,null):ua(G,vn._1,vn._2)}}),ur){ur=!1;return}break}vn===null?K=null:(K=vn._1,vn=vn._2)}}function _t(or){return function(K){return function(){delete w[or._1],or._3=K,ua(K,or._2._1,or._2._2)}}}function we(){var or=jr,K=ar,vn=null,J=null,G,hn;n:for(;;)switch(G=null,hn=null,or){case jr:switch(K.tag){case s:vn&&(J=new S(p,vn,J)),vn=new S(s,K._1,n,n),K=K._2;break;case m:vn&&(J=new S(p,vn,J)),vn=new S(m,n,K._2,n),K=K._1;break;case d:vn&&(J=new S(p,vn,J)),vn=new S(d,n,K._2,n),K=K._1;break;default:hn=V++,or=et,G=K,K=new S(Dn,hn,new S(p,vn,J),n),G=Nc(O,Ln,G),G.onComplete({rethrow:!1,handler:_t(K)})(),w[hn]=G,Ln&&Ln.register(G)}break;case et:if(vn===null)break n;vn._1===n?(vn._1=K,or=jr,K=vn._2,vn._2=n):(vn._2=K,K=vn,J===null?vn=null:(vn=J._1,J=J._2))}for($n=K,hn=0;hn<V;hn++)w[hn].run()}function Le(or,K){Er=O.left(or);var vn;for(var J in mn)if(mn.hasOwnProperty(J)){vn=mn[J];for(J in vn)vn.hasOwnProperty(J)&&vn[J]()}mn=null;var G=fr(or,$n,K);return function(hn){return new S(o,function(Fn){return function(){for(var ur in G)G.hasOwnProperty(ur)&&G[ur]();return Ct}})}}return we(),function(or){return new S(o,function(K){return function(){return Le(or,K)}})}}function Hb(O,Ln,ar){return new S(o,function(Rn){return function(){return Sb(O,Ln,ar,Rn)}})}return S.EMPTY=n,S.Pure=Jn(r),S.Throw=Jn(t),S.Catch=Jn(e),S.Sync=Jn(a),S.Async=Jn(o),S.Bind=Jn(i),S.Bracket=Jn(c),S.Fork=Jn(f),S.Seq=Jn(l),S.ParMap=Jn(s),S.ParApply=Jn(m),S.ParAlt=Jn(d),S.Fiber=Nc,S.Supervisor=Nb,S.Scheduler=Zu,S.nonCanceler=Ct,S}(),Sd=Lr.Pure,Hd=Lr.Throw;function Rd(n){return function(r){return Lr.Catch(n,r)}}function Wd(n){return function(r){return r.tag===Lr.Pure.tag?Lr.Pure(n(r._1)):Lr.Bind(r,function(t){return Lr.Pure(n(t))})}}function Pd(n){return function(r){return Lr.Bind(n,r)}}function us(n){return function(r){return Lr.Fork(n,r)}}var Od=Lr.Sync;function $d(n){return function(r){return Lr.ParMap(n,r)}}function qd(n){return function(r){return Lr.ParApply(n,r)}}var fo=Lr.Async;function uf(n){return function(r){return function(t){return Lr.Bracket(n,r,t)}}}function Ud(n,r){return function(){return Lr.Fiber(n,null,r)}}var Bd=function(){function n(t,e){return t===0&&typeof setImmediate<"u"?setImmediate(e):setTimeout(e,t)}function r(t,e){return t===0&&typeof clearImmediate<"u"?clearImmediate(e):clearTimeout(e)}return function(t,e){return Lr.Async(function(a){return function(){var o=n(e,a(t()));return function(){return Lr.Sync(function(){return t(r(e,o))})}}})}}(),kd=Lr.Seq;var hM=g(Bo);var is=function(n){return n};var fs=function(n){return n};var ff=function(n){return function(r){return n(r)}},bM=function(n){var r=g(n);return{map:function(t){return ff(r(hM(t)))}}};var cs=function(n){return{Applicative0:function(){return Tu(n)},Bind1:function(){return cf(n)}}},cf=function(n){var r=x(n.Bind1()),t=T(n.Applicative0());return{bind:function(e){return function(a){return r(e)(vt(function(o){return t(gn.create(o))})(function(o){var i=a(o);return i}))}},Apply0:function(){return Vd(n)}}},Vd=function(n){var r=bM(n.Bind1().Apply0().Functor0());return{apply:$r(cs(n)),Functor0:function(){return r}}},Tu=function(n){return{pure:function(){var r=T(n.Applicative0());return function(t){return is(r(yn.create(t)))}}(),Apply0:function(){return Vd(n)}}};var Jd=function(n){var r=cs(n);return{throwError:function(){var t=T(n.Applicative0());return function(e){return is(t(gn.create(e)))}}(),Monad0:function(){return r}}};var lo=function(n){return n.sequential},Qe=function(n){return n.parallel};var FM=X(Y),wM=function(n){var r=lo(n),t=cr(n.Applicative1()),e=Qe(n);return function(a){var o=t(a);return function(i){var c=o(function(f){return e(i(f))});return function(f){return r(c(f))}}}};var Cu=function(n){var r=wM(n);return function(t){return r(t)(FM)}};var so=function(n){return n()};var Kd=function(n,r,t){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return e=1,a=t(),e=2,a}},IM=T(Gn),Xd=qn(sn),Yd=g(sn);var xM=function(n){return n},Zd=us(!1);var AM={map:$d},Ge={map:Wd},NM=g(Ge),nD=us(!0),SM=function(){var n=function(e){if(e instanceof yn)return e.value0;if(e instanceof gn)return ke("unsafeFromRight: Left");throw new Error("Failed pattern match at Effect.Aff (line 412, column 21 - line 414, column 54): "+[e.constructor.name])},r=function(e){if(e instanceof gn)return e.value0;if(e instanceof yn)return ke("unsafeFromLeft: Right");throw new Error("Failed pattern match at Effect.Aff (line 407, column 20 - line 409, column 55): "+[e.constructor.name])},t=function(e){if(e instanceof gn)return!0;if(e instanceof yn)return!1;throw new Error("Failed pattern match at Effect.Aff (line 402, column 12 - line 404, column 21): "+[e.constructor.name])};return{isLeft:t,fromLeft:r,fromRight:n,left:gn.create,right:yn.create}}(),rD=function(n){return Ud(SM,n)},HM=function(n){return function(){var t=rD(n)();return t.run(),t}};var tD=function(n){return Bd(yn.create,n)},RM=function(n){return function(r){return uf(n)({killed:$(r),failed:$(r),completed:$(r)})}},WM={apply:qd,Functor0:function(){return AM}};var Fa={Applicative0:function(){return te},Bind1:function(){return kr}},kr={bind:Pd,Apply0:function(){return eD(0)}},te={pure:Sd,Apply0:function(){return eD(0)}},eD=Kd("applyAff","Effect.Aff",function(){return{apply:$r(Fa),Functor0:function(){return Ge}}});var pf=T(te),aD=x(kr);var PM=Yn(kr);var oD=function(n){return function(r){return RM(pf(void 0))($(n))($(r))}};var Tt={liftEffect:Od,Monad0:function(){return Fa}},sf=zn(Tt),_f=function(n){return xM($(sf(n)))},Eu=function(n){return fo(function(r){return Yd(_f)(n.join(r))})},uD={map:function(n){return function(r){return so(rD(NM(n)(Eu(r))))}}};var Mu=function(n){return function(r){return aD(sf(r.isSuspended))(function(t){return t?sf(Xd(r.kill(n,$(IM(void 0))))):fo(function(e){return Yd(_f)(r.kill(n,e))})})}};var mf={throwError:Hd,Monad0:function(){return Fa}},iD={catchError:Rd,MonadThrow0:function(){return mf}},OM=ns(iD);var $M=function(n){return function(r){return HM(PM(function(t){return sf(n(t))})(OM(r)))}},vf=function(n){return function(r){return Xd($M(n)(r))}};var wa={parallel:y,sequential:kd,Monad0:function(){return Fa},Applicative1:function(){return fD(0)}},fD=Kd("applicativeParAff","Effect.Aff",function(){return{pure:function(){var n=Qe(wa);return function(r){return n(pf(r))}}(),Apply0:function(){return WM}}}),ps=fD(136);var df={tailRecM:function(n){var r=function(t){return aD(n(t))(function(e){if(e instanceof sr)return pf(e.value0);if(e instanceof pr)return r(e.value0);throw new Error("Failed pattern match at Effect.Aff (line 104, column 7 - line 106, column 23): "+[e.constructor.name])})};return r},Monad0:function(){return Fa}};var cD=$(pf(void 0));function lD(n,r,t){return function(){var e=document.getElementById(n);return e&&e instanceof HTMLCanvasElement?r(e):t}}function _s(n){return function(){return n.getContext("2d")}}function ms(n){return function(){return n.width}}function vs(n){return function(){return n.height}}function ds(n){return function(r){return function(){n.lineWidth=r}}}function Ds(n){return function(r){return function(){n.fillStyle=r}}}function gs(n){return function(r){return function(){n.globalAlpha=r}}}function Fu(n){return function(){n.beginPath()}}function Df(n){return function(){n.stroke()}}function gf(n){return function(){n.fill()}}function ys(n){return function(r){return function(t){return function(){n.lineTo(r,t)}}}}function yf(n){return function(r){return function(t){return function(){n.moveTo(r,t)}}}}function hf(n){return function(){n.closePath()}}function hs(n){return function(r){return function(){n.arc(r.x,r.y,r.radius,r.start,r.end,r.useCounterClockwise)}}}function bs(n){return function(r){return function(){n.clearRect(r.x,r.y,r.width,r.height)}}}function Ts(n){return function(r){return function(){return n.createLinearGradient(r.x0,r.y0,r.x1,r.y1)}}}function bf(n){return function(r){return function(t){return function(){n.addColorStop(r,t)}}}}var sD=function(n){return lD(n,v.create,D.value)},pD=function(n){return function(){var t=ms(n)(),e=vs(n)();return{width:t,height:e}}};var Cs=y,_D=y;var GM=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var mD=function(n){return function(r){return Cs(function(t){return n(t.value0)(t.value1)})(r)}};var vD=function(n){return function(r){return _D(new GM(n,r))}},Es={map:function(n){return function(r){return Cs(function(t){return vD(function(e){return n(t.value0(e))})(t.value1)})(r)}}};var dD=vD(X(Y));var KM=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}();var Tf=function(n){return KM.create(on(n.Eq0()))(B(n))},XM={eq:function(n){return function(r){return n.value0(n.value2)(r.value2)}}},DD={compare:function(n){return function(r){return n.value1(n.value2)(r.value2)}},Eq0:function(){return XM}};var Fs=Ko(Vr)(DD);var nF=Xl(Fs),rF=ht(Fs),tF=Zr(Fs);var gD=function(){return function(n){var r=Kr(n);return function(t){var e=Tf(t);return function(a){return function(o){return function(i){return nF(new I(r(a),e(o)))(i)}}}}}},Cf=function(){return function(n){var r=Kr(n);return function(t){var e=Tf(t);return function(a){return function(o){return function(i){return rF(new I(r(a),e(o)))(i)}}}}}},yD=function(){return function(n){var r=Kr(n);return function(t){var e=Tf(t);return function(a){return function(o){return function(i){return function(c){return tF(new I(r(a),e(o)))(i)(c)}}}}}}},hD=function(n){var r=cr(n)(br);return function(t){return function(e){return r(function(a){return e(a)})(t)}}},po=wr;var Mf=function(){function n(){}return n.value=new n,n}(),bD=function(){function n(){}return n.value=new n,n}(),TD=function(){function n(){}return n.value=new n,n}(),CD=function(n){if(n instanceof Mf)return"button";if(n instanceof bD)return"submit";if(n instanceof TD)return"reset";throw new Error("Failed pattern match at DOM.HTML.Indexed.ButtonType (line 14, column 20 - line 17, column 25): "+[n.constructor.name])};var MD=function(){function n(){}return n.value=new n,n}(),Ff=function(){function n(){}return n.value=new n,n}(),FD=function(){function n(){}return n.value=new n,n}(),wD=function(){function n(){}return n.value=new n,n}(),LD=function(){function n(){}return n.value=new n,n}(),ID=function(){function n(){}return n.value=new n,n}(),xD=function(){function n(){}return n.value=new n,n}(),AD=function(){function n(){}return n.value=new n,n}(),ND=function(){function n(){}return n.value=new n,n}(),SD=function(){function n(){}return n.value=new n,n}(),wf=function(){function n(){}return n.value=new n,n}(),HD=function(){function n(){}return n.value=new n,n}(),RD=function(){function n(){}return n.value=new n,n}(),WD=function(){function n(){}return n.value=new n,n}(),PD=function(){function n(){}return n.value=new n,n}(),OD=function(){function n(){}return n.value=new n,n}(),$D=function(){function n(){}return n.value=new n,n}(),qD=function(){function n(){}return n.value=new n,n}(),UD=function(){function n(){}return n.value=new n,n}(),BD=function(){function n(){}return n.value=new n,n}(),kD=function(){function n(){}return n.value=new n,n}(),zD=function(){function n(){}return n.value=new n,n}(),VD=function(n){if(n instanceof MD)return"button";if(n instanceof Ff)return"checkbox";if(n instanceof FD)return"color";if(n instanceof wD)return"date";if(n instanceof LD)return"datetime-local";if(n instanceof ID)return"email";if(n instanceof xD)return"file";if(n instanceof AD)return"hidden";if(n instanceof ND)return"image";if(n instanceof SD)return"month";if(n instanceof wf)return"number";if(n instanceof HD)return"password";if(n instanceof RD)return"radio";if(n instanceof WD)return"range";if(n instanceof PD)return"reset";if(n instanceof OD)return"search";if(n instanceof $D)return"submit";if(n instanceof qD)return"tel";if(n instanceof UD)return"text";if(n instanceof BD)return"time";if(n instanceof kD)return"url";if(n instanceof zD)return"week";throw new Error("Failed pattern match at DOM.HTML.Indexed.InputType (line 33, column 19 - line 55, column 22): "+[n.constructor.name])};var ws=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Ke=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();function QD(n,r,t){return n==null?r:t(n)}function Ls(n){return n}var Te=Hn(null)(Ls),Vn=function(n){return QD(n,D.value,v.create)};var rr=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}(),Iu=y,nt=function(n,r){return n.value2(n.value1,r)},tr=y,rt=function(n){return n.value3(n.value1)},Wr=Iu(function(n){return n.value0});var GD=g(vr),gF=g(va);var Xe=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Ce=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}(),Ye=function(){function n(r,t,e,a){this.value0=r,this.value1=t,this.value2=e,this.value3=a}return n.create=function(r){return function(t){return function(e){return function(a){return new n(r,t,e,a)}}}},n}(),Ze=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Ee=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),yF=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),jD=function(n){return function(r){return n(r)}};var hF=y;var bF={bimap:function(n){return function(r){return jD(function(t){return hF(new yF(function(e){return n(t.value0(e))},function(e){return r(t.value1(e))},t.value2))})}}},TF=de(bF);var La=jD(function(n){var r=function(t){if(t instanceof Xe)return new Xe(t.value0);if(t instanceof Ce)return new Ce(t.value0,t.value1,n.value0(t.value2),GD(r)(t.value3));if(t instanceof Ye)return new Ye(t.value0,t.value1,n.value0(t.value2),GD(gF(r))(t.value3));if(t instanceof Ze)return new Ze(n.value1(t.value0));if(t instanceof Ee)return new Ee(TF(n.value0)(n.value1)(t.value0));throw new Error("Failed pattern match at Halogen.VDom.Types (line 86, column 7 - line 86, column 27): "+[t.constructor.name])};return r(n.value2)});function Ia(n,r){return r[n]}function xs(n,r){return r.hasOwnProperty(n)}function Me(n,r,t){t[n]=r}function As(n,r){for(var t=[],e=0;e<n.length;e++)t.push(r(e,n[e]));return t}function Ns(n,r){for(var t=0;t<n.length;t++)r(n[t])}function Ss(n,r){for(var t=Object.keys(n),e=0;e<t.length;e++){var a=t[e];r(a,n[a])}}function Hs(n,r,t,e,a){for(var o=[],i=n.length,c=r.length,f=0;;){if(f<i)f<c?o.push(t(f,n[f],r[f])):e(f,n[f]);else if(f<c)o.push(a(f,r[f]));else break;f++}return o}function xu(n,r,t){for(var e={},a=0;a<n.length;a++){var o=n[a],i=r(o);e[i]=t(i,a,o)}return e}function Au(n,r,t,e,a,o){for(var i={},c=0;c<r.length;c++){var f=r[c],l=t(f);n.hasOwnProperty(l)?i[l]=e(l,c,n[l],f):i[l]=o(l,c,f)}for(var l in n)l in i||a(l,n[l]);return i}function xa(n,r){return n===r}function Rs(n,r){return r.createTextNode(n)}function Ws(n,r){r.textContent=n}function If(n,r,t){return n!=null?t.createElementNS(n,r):t.createElement(r)}function na(n,r,t){var e=t.childNodes.item(n)||null;e!==r&&t.insertBefore(r,e)}function Nu(n,r){r&&n.parentNode===r&&r.removeChild(n)}function Su(n){return n.parentNode}function xf(n,r,t,e){n!=null?e.setAttributeNS(n,r,t):e.setAttribute(r,t)}function Af(n,r,t){n!=null?t.removeAttributeNS(n,r):t.removeAttribute(r)}function Ps(n,r,t){return n!=null?t.hasAttributeNS(n,r):t.hasAttribute(r)}function Os(n,r,t){t.addEventListener(n,r,!1)}function $s(n,r,t){t.removeEventListener(n,r,!1)}var qs=void 0;var Nf=function(){return{}};var Us=Ia,Bs=y,ks=Me,zs=Nf;var Sf=function(n){return function(r){return r[n]}},LF=Sf("namespaceURI"),IF=Sf("prefix"),xF=Sf("localName"),AF=Sf("tagName");var Hf=function(n){return function(r){return function(){return r[n]}}},SF=Hf("children"),HF=Hf("firstElementChild"),RF=Hf("lastElementChild"),WF=Hf("childElementCount");function XD(n){return function(r){return function(){return r.querySelector(n)}}}var OF=g(sn);var YD=function(n){var r=OF(Vn),t=XD(n);return function(e){return r(t(e))}};var Js=y;var Hu=function(n,r,t){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return e=1,a=t(),e=2,a}};var Qs=function(n){return rt(n.widget)},Gs=Hu("patchWidget","Halogen.VDom.DOM",function(){return function(n,r){if(r instanceof Ee)return Gs(291)(n,La(r.value0));if(r instanceof Ze){var t=nt(n.widget,r.value0),e=Iu(function(a){return tr(new rr(a.value0,{build:n.build,widget:t},Gs(296),Qs))})(t);return e}return Qs(n),n.build(r)}}),zF=Gs(286),Rf=function(n){var r=Su(n.node);return Nu(n.node,r)},Wf=Hu("patchText","Halogen.VDom.DOM",function(){return function(n,r){if(r instanceof Ee)return Wf(82)(n,La(r.value0));if(r instanceof Xe){if(n.value===r.value0)return tr(new rr(n.node,n,Wf(85),Rf));if(Sn){var t={build:n.build,node:n.node,value:r.value0};return Ws(r.value0,n.node),tr(new rr(n.node,t,Wf(89),Rf))}}return Rf(n),n.build(r)}}),VF=Wf(77),Pf=function(n){var r=Su(n.node);return Nu(n.node,r),Ss(n.children,function(t,e){return rt(e)}),rt(n.attrs)},Of=function(n){var r=Su(n.node);return Nu(n.node,r),Ns(n.children,rt),rt(n.attrs)},ZD=function(n,r,t,e){var a=r===e;return a?n instanceof v&&t instanceof v&&n.value0===t.value0||n instanceof D&&t instanceof D:!1},$f=Hu("patchElem","Halogen.VDom.DOM",function(){return function(n,r){if(r instanceof Ee)return $f(135)(n,La(r.value0));if(r instanceof Ce&&ZD(n.ns,n.name,r.value0,r.value1)){var t=ot(r.value3),e=ot(n.children);if(e===0&&t===0){var f=nt(n.attrs,r.value2),l={build:n.build,node:n.node,attrs:f,ns:r.value0,name:r.value1,children:n.children};return tr(new rr(n.node,l,$f(149),Of))}var a=function(s,m){return rt(m)},o=function(s,m,d){var p=nt(m,d);return na(s,Wr(p),n.node),p},i=function(s,m){var d=n.build(m);return na(s,Wr(d),n.node),d},c=Hs(n.children,r.value3,o,a,i),f=nt(n.attrs,r.value2),l={build:n.build,node:n.node,attrs:f,ns:r.value0,name:r.value1,children:c};return tr(new rr(n.node,l,$f(172),Of))}return Of(n),n.build(r)}}),JF=$f(130),qf=Hu("patchKeyed","Halogen.VDom.DOM",function(){return function(n,r){if(r instanceof Ee)return qf(222)(n,La(r.value0));if(r instanceof Ye&&ZD(n.ns,n.name,r.value0,r.value1)){var t=ot(r.value3);if(n.length===0&&t===0){var c=nt(n.attrs,r.value2),f={build:n.build,node:n.node,attrs:c,ns:r.value0,name:r.value1,children:n.children,length:0};return tr(new rr(n.node,f,qf(237),Pf))}var e=function(l,s){return rt(s)},a=function(l,s,m,d){var p=nt(m,d.value1);return na(s,Wr(p),n.node),p},o=function(l,s,m){var d=n.build(m.value1);return na(s,Wr(d),n.node),d},i=Au(n.children,r.value3,Hr,a,e,o),c=nt(n.attrs,r.value2),f={build:n.build,node:n.node,attrs:c,ns:r.value0,name:r.value1,children:i,length:t};return tr(new rr(n.node,f,qf(261),Pf))}return Pf(n),n.build(r)}}),QF=qf(217),GF=function(n,r,t){var e=n.buildWidget(n)(t),a=Iu(function(o){return tr(new rr(o.value0,{build:r,widget:e},zF,Qs))})(e);return a},jF=function(n,r,t){var e=Rs(t,n.document),a={build:r,node:e,value:t};return tr(new rr(e,a,VF,Rf))},KF=function(n,r,t,e,a,o){var i=If(Te(t),e,n.document),c=Js(i),f=function(d,p,u){var _=r(u.value1);return na(p,Wr(_),c),_},l=xu(o,Hr,f),s=n.buildAttributes(i)(a),m={build:r,node:c,attrs:s,ns:t,name:e,children:l,length:ot(o)};return tr(new rr(c,m,QF,Pf))},XF=function(n,r,t,e,a,o){var i=If(Te(t),e,n.document),c=Js(i),f=function(d,p){var u=r(p);return na(d,Wr(u),c),u},l=As(o,f),s=n.buildAttributes(i)(a),m={build:r,node:c,attrs:s,ns:t,name:e,children:l};return tr(new rr(c,m,JF,Of))},Ru=function(n){var r=Hu("build","Halogen.VDom.DOM",function(){return function(e){if(e instanceof Xe)return jF(n,r(59),e.value0);if(e instanceof Ce)return XF(n,r(60),e.value0,e.value1,e.value2,e.value3);if(e instanceof Ye)return KF(n,r(61),e.value0,e.value1,e.value2,e.value3);if(e instanceof Ze)return GF(n,r(62),e.value0);if(e instanceof Ee)return r(63)(La(e.value0));throw new Error("Failed pattern match at Halogen.VDom.DOM (line 58, column 27 - line 63, column 52): "+[e.constructor.name])}}),t=r(58);return t};function Wu(n){return typeof n}function Uf(n){return Object.prototype.toString.call(n).slice(8,-1)}var rg=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};var Bf=function(){var n=Wi(ql);return function(r){return Pl(n(r))}}();var tg=function(n){return function(r){return new xt(n,new M(r.value0,r.value1))}};var Xs=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var ug=y,rw=y;var Ys=function(n){var r=Qr(Jd(n));return function(t){return r(Bf(t))}};var ig=function(n){var r=T(Tu(n)),t=Ys(n);return function(e){return function(a){if(Uf(a)===e)return r(rw(a));if(Sn)return t(new Xs(e,Uf(a)));throw new Error("Failed pattern match at Foreign (line 123, column 1 - line 123, column 104): "+[e.constructor.name,a.constructor.name])}}},fg=function(n){return ig(n)("Boolean")};var cg=function(n){return ig(n)("String")};function lg(n,r,t,e){return t in e?r(e[t]):n}function np(n){return function(r){var t=[];for(var e in r)hasOwnProperty.call(r,e)&&t.push(n(e)(r[e]));return t}}var tw=Object.keys||np(function(n){return function(){return n}});var rp=function(n){return function(r){return function(t){return function(e){return function(a){return n(r,t,e,a)}}}}};var pg=function(){return rp(lg)(D.value)(v.create)}();function Pu(n){return function(){return function(r){return n(r)()}}}function tp(n){return function(r){return function(t){return function(e){return function(){return e.addEventListener(n,r,t)}}}}}function ep(n){return function(r){return function(t){return function(e){return function(){return e.removeEventListener(n,r,t)}}}}}var cw=function(n,r,t){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return e=1,a=t(),e=2,a}};var vg=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),dg=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),ra=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),ta=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),ea=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),_o=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),lw=Ia,ap=Me,sw=function(n,r){var t=Ps(null,n,r);if(t)return Af(null,n,r);var e=Wu(Ia(n,r));return e==="string"?Me(n,"",r):n==="rowSpan"?Me(n,1,r):n==="colSpan"?Me(n,1,r):Me(n,qs,r)},mg=function(n){if(n instanceof ra&&n.value0 instanceof v)return"attr/"+(n.value0.value0+(":"+n.value1));if(n instanceof ra)return"attr/:"+n.value1;if(n instanceof ta)return"prop/"+n.value0;if(n instanceof ea)return"handler/"+n.value0;if(n instanceof _o)return"ref";throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 182, column 16 - line 187, column 16): "+[n.constructor.name])},kf=y,Dg=y,gg=y;var yg=function(n){return function(r){var t=function(s){return function(m,d){if(d instanceof ra)return Af(Te(d.value0),d.value1,r);if(d instanceof ta)return sw(d.value0,r);if(d instanceof ea){var p=Us(d.value0,s);return $s(d.value0,Hr(p),r)}if(d instanceof _o)return void 0;throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 169, column 5 - line 179, column 18): "+[d.constructor.name])}},e=function(s){return s instanceof v?n(s.value0)():void 0},a=function(s){var m=pg("ref")(s.props);return m instanceof v&&m.value0 instanceof _o?e(m.value0.value0(new dg(r))):void 0},o=function(s,m){return function(d,p,u,_){if(u instanceof ra&&_ instanceof ra){var H=u.value2===_.value2;return H||xf(Te(_.value0),_.value1,_.value2,r),_}if(u instanceof ta&&_ instanceof ta){var pn=xa(u.value1,_.value1);if(pn)return _;if(_.value0==="value"){var Dn=lw("value",r),In=xa(Dn,_.value1);return In||ap(_.value0,_.value1,r),_}return ap(_.value0,_.value1,r),_}if(u instanceof ea&&_ instanceof ea){var tn=Us(_.value0,s);return Pn(_.value1)(Kn(tn))(),ks(_.value0,tn,m),_}return _}},i=function(s){return function(m,d,p){if(p instanceof ra)return xf(Te(p.value0),p.value1,p.value2,r),p;if(p instanceof ta)return ap(p.value0,p.value1,r),p;if(p instanceof ea){var u=Ia(p.value0,s);if(xs(p.value0,s))return Pn(p.value1)(Kn(u))(),p;var _=jn(p.value1)(),H=Pu(function(pn){return function(){var In=z(_)();return e(In(pn))}})();return ks(p.value0,new I(H,_),s),Os(p.value0,H,r),p}if(p instanceof _o)return e(p.value0(new vg(r))),p;throw new Error("Failed pattern match at Halogen.VDom.DOM.Prop (line 113, column 5 - line 135, column 15): "+[p.constructor.name])}},c=cw("patchProp","Halogen.VDom.DOM.Prop",function(){return function(s,m){var d=zs(),p=t(s.events),u=o(s.events,d),_=i(d),H=Au(s.props,m,mg,u,p,_),pn={events:Bs(d),props:H};return tr(new rr(void 0,pn,c(100),a))}}),f=c(87),l=function(s){var m=zs(),d=xu(s,mg,i(m)),p={events:Bs(m),props:d};return tr(new rr(void 0,p,f,a))};return l}};var up=function(n){return n},Cg=function(n){return up(Ze.create(n))},mw=function(n){return n.toPropValue},mo=function(n){return up(Xe.create(n))};var Eg=function(n){var r=mw(n);return function(t){var e=ta.create(t);return function(a){return e(r(a))}}};var Mg={toPropValue:kf};var Fg={toPropValue:Dg};var zf={toPropValue:gg},wg={toPropValue:function(n){return kf(VD(n))}};var Lg={toPropValue:function(n){return kf(CD(n))}};var Vf=function(){return ea.create}(),Ig=function(n){return function(r){return function(t){return function(e){return new Ce(n,r,t,e)}}}};var vw=X(Y);var Jf=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),ip=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),fp=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),xg=function(n){return function(r){return new fp(n,r)}},Ag=function(){return ip.create}(),Ng=function(n){var r=T(n);return function(t){return function(e){return function(a){return function(o){return function(i){if(o instanceof Jf)return new I(new M({func:r(o.value0),count:i},t),e);if(o instanceof ip)return new I(new M({func:a(o.value0),count:i},t),e);if(o instanceof fp)return Ng(n)(t)(tg(o.value1)(e))(a)(o.value0)(i+1|0);throw new Error("Failed pattern match at Control.Applicative.Free (line 102, column 41 - line 105, column 81): "+[o.constructor.name])}}}}}},Sg=function(n){var r=Cn(n.Apply0());return function(t){return function(e){return function(a){if(t instanceof F)return new gn(a);if(t instanceof M){var o=r(t.value0.func)(a),i=t.value0.count===1;if(i)return t.value1 instanceof F?new gn(o):Sg(n)(t.value1)(e)(o);if(e instanceof F)return new gn(o);if(e instanceof M)return new yn(new I(new M({func:o,count:t.value0.count-1|0},t.value1),new xt(e.value0,e.value1)));throw new Error("Failed pattern match at Control.Applicative.Free (line 83, column 11 - line 88, column 50): "+[e.constructor.name])}throw new Error("Failed pattern match at Control.Applicative.Free (line 72, column 3 - line 88, column 50): "+[t.constructor.name])}}}},Hg={map:function(n){return function(r){return xg(new Jf(n))(r)}}},Rg=function(n){var r=Sg(n),t=T(n),e=Ng(n);return function(a){return function(o){var i=function(c){var f=!1,l;function s(m){if(m.value1.value0 instanceof Jf){var d=r(m.value0)(m.value1.value1)(t(m.value1.value0.value0));if(d instanceof gn)return f=!0,d.value0;if(d instanceof yn){c=d.value0;return}throw new Error("Failed pattern match at Control.Applicative.Free (line 54, column 17 - line 56, column 24): "+[d.constructor.name])}if(m.value1.value0 instanceof ip){var d=r(m.value0)(m.value1.value1)(a(m.value1.value0.value0));if(d instanceof gn)return f=!0,d.value0;if(d instanceof yn){c=d.value0;return}throw new Error("Failed pattern match at Control.Applicative.Free (line 57, column 17 - line 59, column 24): "+[d.constructor.name])}if(m.value1.value0 instanceof fp){var p=new xt(m.value1.value0.value1,m.value1.value1);c=e(m.value0)(p)(a)(m.value1.value0.value0)(1);return}throw new Error("Failed pattern match at Control.Applicative.Free (line 53, column 5 - line 62, column 47): "+[m.value1.value0.constructor.name])}for(;!f;)l=s(c);return l};return i(new I(F.value,Bf(o)))}}},Wg=function(n){return Rg(n)(vw)},Pg={apply:function(n){return function(r){return xg(n)(r)}},Functor0:function(){return Hg}},Og=function(){return{pure:Jf.create,Apply0:function(){return Pg}}}(),dw=Rg(Og),cp=function(n){return dw(function(r){return Ag(n(r))})};var Qf=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var qg=function(n){var r=!1,t;function e(a){if(a.value0 instanceof F&&a.value1 instanceof F)return r=!0,D.value;if(a.value0 instanceof F){n=new Qf(Gt(a.value1),F.value);return}if(a.value0 instanceof M)return r=!0,new v(new I(a.value0.value0,new Qf(a.value0.value1,a.value1)));throw new Error("Failed pattern match at Data.CatQueue (line 82, column 1 - line 82, column 63): "+[a.constructor.name])}for(;!r;)t=e(n);return t},Ug=function(n){return function(r){return new Qf(n.value0,new M(r,n.value1))}};var Bg=function(n){return n.value0 instanceof F&&n.value1 instanceof F};var kg=function(){return new Qf(F.value,F.value)}();var Do=function(){function n(){}return n.value=new n,n}(),Gf=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var zg=function(n){return function(r){if(n instanceof Do)return r;if(r instanceof Do)return n;if(n instanceof Gf)return new Gf(n.value0,Ug(n.value1)(r));throw new Error("Failed pattern match at Data.CatList (line 108, column 1 - line 108, column 54): "+[n.constructor.name,r.constructor.name])}},gw=function(n){return function(r){return function(t){var e=function(o){return function(i){return function(c){var f=o,l=i,s=!1,m;function d(p,u,_){if(_ instanceof F)return s=!0,u;if(_ instanceof M){f=p,l=p(u)(_.value0),c=_.value1;return}throw new Error("Failed pattern match at Data.CatList (line 124, column 3 - line 124, column 59): "+[p.constructor.name,u.constructor.name,_.constructor.name])}for(;!s;)m=d(f,l,c);return m}}},a=function(o){return function(i){var c=o,f=!1,l;function s(m,d){var p=qg(m);if(p instanceof D)return f=!0,e(function(u){return function(_){return _(u)}})(r)(d);if(p instanceof v){c=p.value0.value1,i=new M(n(p.value0.value0),d);return}throw new Error("Failed pattern match at Data.CatList (line 120, column 14 - line 122, column 67): "+[p.constructor.name])}for(;!f;)l=s(c,i);return l}};return a(t)(F.value)}}},Vg=function(n){if(n instanceof Do)return D.value;if(n instanceof Gf)return new v(new I(n.value0,function(){var r=Bg(n.value1);return r?Do.value:gw(zg)(Do.value)(n.value1)}()));throw new Error("Failed pattern match at Data.CatList (line 99, column 1 - line 99, column 61): "+[n.constructor.name])};var Jg=function(){return Do.value}(),Qg=zg;var Gg={append:Qg};var jg=function(n){return function(r){return Qg(n)(new Gf(r,kg))}};var hw=function(n,r,t){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return e=1,a=t(),e=2,a}},bw=q(Gg);var lp=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),jf=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Kf=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Tw=function(n){var r=!1,t;function e(a){var o=function(f){return f},i=function(f){return function(l){return new lp(f.value0,bw(f.value1)(l))}};if(a.value0 instanceof jf){var c=Vg(a.value1);if(c instanceof D)return r=!0,new jf(a.value0.value0);if(c instanceof v){n=i(o(c.value0.value0)(a.value0.value0))(c.value0.value1);return}throw new Error("Failed pattern match at Control.Monad.Free (line 227, column 7 - line 231, column 64): "+[c.constructor.name])}if(a.value0 instanceof Kf)return r=!0,new Kf(a.value0.value0,function(f){return i(a.value0.value1(f))(a.value1)});throw new Error("Failed pattern match at Control.Monad.Free (line 225, column 3 - line 233, column 56): "+[a.value0.constructor.name])}for(;!r;)t=e(n);return t};var Kg=function(n){return new lp(n,Jg)};var sp={Applicative0:function(){return Ou},Bind1:function(){return Xf}},pp={map:function(n){return function(r){return Yn(Xf)(function(){var t=T(Ou);return function(e){return t(n(e))}}())(r)}}},Xf={bind:function(n){return function(r){return new lp(n.value0,jg(n.value1)(r))}},Apply0:function(){return _p(0)}},Ou={pure:function(n){return Kg(jf.create(n))},Apply0:function(){return _p(0)}},_p=hw("freeApply","Control.Monad.Free",function(){return{apply:$r(sp),Functor0:function(){return pp}}}),Xg=_p(77);var Cw=T(Ou);var Yf=function(n){return Kg(new Kf(n,function(r){return Cw(r)}))};var Yg=function(n){var r=n.Monad0(),t=g(r.Bind1().Apply0().Functor0()),e=T(r.Applicative0()),a=lt(n);return function(o){var i=function(c){var f=Tw(c);if(f instanceof jf)return t(sr.create)(e(f.value0));if(f instanceof Kf)return t(function(l){return pr.create(f.value1(l))})(o(f.value0));throw new Error("Failed pattern match at Control.Monad.Free (line 158, column 10 - line 160, column 37): "+[f.constructor.name])};return a(i)}};var ty=function(){function n(r,t,e){this.value0=r,this.value1=t,this.value2=e}return n.create=function(r){return function(t){return function(e){return new n(r,t,e)}}},n}(),ey=y,ay=y;function mp(n){return function(r){return n===r}}var go=mp;var Nw=qn(sn);var Sw=x(ft);var Hw=q(at),Rw=cr(Gn),Ww=Rw(pt);var Zf=function(n){return n},uy=function(n){return function(r){return n(function(t){return Nw(r(t))})}};var iy=function(n){return function(r){return n(r)}};var fy=function(){var r=jn([])();return{emitter:function(t){return function(){return ct(function(a){return Hw(a)([t])})(r)(),ct(bl(go)(t))(r)}},listener:function(t){return Sw(z(r))(Ww(function(e){return e(t)}))}}};var Ow=X(Y);var $w=Cf();var ly=function(n){return n},sy=function(n){return n},$u=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),nc=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),rc=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),qu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Uu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),tc=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),ec=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),ac=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),oc=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),uc=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),ic=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var fc=function(n){return n};var cc=function(){return function(n){var r=$w(n);return function(t){var e=r(t);return function(a){return function(o){return function(i){return Yf(new Uu(ay(new ty(function(c){var f=T(c);return function(l){var s=Hn(f(D.value))(l),m=e(a)(o);return function(d){return s(m(d))}}},i,Ow))))}}}}}},Dp=wn,lc=wn;var py=sp,sc={state:function(n){return fc(Yf($u.create(n)))},Monad0:function(){return py}};var _y=function(n){return{liftEffect:function(){var r=zn(n);return function(t){return fc(Yf(qu.create(r(t))))}}(),Monad0:function(){return py}}};var Bu=pp;var gp=Xf;var pc=Xg;var Aa=Ou;var yo=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),ho=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),bo=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),To=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Co=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}();var qw=function(n,r,t){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return e=1,a=t(),e=2,a}};var Uw=function(n,r){return xa(n.value0,r.value0)&&xa(n.value1,r.value1)&&n.value1(n.value3,r.value3)};var my=function(n){return n.value2(n.value3)};var vy=function(n){var r=function(o){return rt(o.vdom)},t=qw("patchThunk","Halogen.VDom.Thunk",function(){return function(o,i){var c=Uw(o.thunk,i);if(c)return tr(new rr(Wr(o.vdom),o,t(112),r));var f=nt(o.vdom,n(my(i)));return tr(new rr(Wr(f),{vdom:f,thunk:i},t(115),r))}}),e=t(108),a=function(o){return function(i){var c=Ru(o)(n(my(i)));return tr(new rr(Wr(c),{thunk:i,vdom:c},e,r))}};return a};var _c=Wa(Bu),bp=cr(Aa)(yr),Bw=g(Bu);var dy=T(Aa),kw=Cf(),zw=gD(),Vw=yD(),zu=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),mc=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Tp=y,Cp=y,Vu=function(n){return function(r){if(r instanceof yo)return _c(bp(n.handleAction)(n.initialize))(r.value0);if(r instanceof ho)return _c(bp(n.handleAction)(n.finalize))(r.value0);if(r instanceof bo)return _c(bp(n.handleAction)(n.receive(r.value0)))(r.value1);if(r instanceof To)return _c(n.handleAction(r.value0))(r.value1);if(r instanceof Co)return mD(function(t){var e=Bw(Hn(r.value1(void 0))(t));return function(a){return e(n.handleQuery(a))}})(r.value0);throw new Error("Failed pattern match at Halogen.Component (line 182, column 15 - line 192, column 71): "+[r.constructor.name])}},Jw=y,Ju=y;var aa=function(){return{handleAction:$(dy(void 0)),handleQuery:$(dy(D.value)),receive:$(D.value),initialize:D.value,finalize:D.value}}(),Ep=function(){return function(n){var r=kw(n),t=zw(n),e=Vw(n);return function(a){var o=r(a),i=t(a),c=e(a);return function(f){return function(l){return function(s){return function(m){return function(d){return Jw({get:o(f)(l),pop:i(f)(l),set:c(f)(l),component:s,input:m,output:d})}}}}}}}};var Eo=function(){return Ig(D.value)}();var vc=function(n){return Eo("input")(n)([])};var Dy=Eo("label"),dc=Dy([]);var ee=Eo("div"),Dc=ee([]);var Mp=function(n){return Eo("canvas")(n)([])},Fp=Eo("button");var Qw=gr();var Na=function(n){return Eg(n)};var gc=Na(Mg),yy=Na(zf),Gw=Na(Fg);var wp=gc("title"),Lp=function(n){return Na(n)("type")};var hy=yy("width");var by=gc("placeholder");var Ty=Gw("min");var Ip=gc("id");var Cy=yy("height");var Rt=function(){var n=gc("className");return function(r){return n(Qw(r))}}();var My=function(n){return function(r){return{x:r.x*n,y:r.y*n}}};var Fy=function(n){return function(r){return{x:n.x+r.left,y:n.y+r.top}}};var yc=function(n){return{x:n.r*uu(n.theta),y:n.r*Ka(n.theta)}},wy=function(n){return function(r){return{r:n,theta:r}}};var Kw=dt(Fr),Xw=it(Fr),Yw=Ca(Ma),Zw=Re(Bv),n1=q(Be),r1=Tn(Zn),Iy=function(n){return function(r){var t=function(e){return function(a){var o=e,i=!1,c;function f(l,s){if(s===0)return i=!0,new M(0,l);if(Sn){var m=Kw(s)(n);o=new M(m,l),a=Xw(s-m|0)(n);return}throw new Error("Failed pattern match at PadicVector (line 18, column 4 - line 22, column 37): "+[l.constructor.name,s.constructor.name])}for(;!i;)c=f(o,a);return c}};return Gt(t(F.value)(r))}},t1=function(n){return function(r){return function(t){var e=Ui/On(n)*On(t),a=1/On(Oe(n)(r));return wy(a)(e)}}},e1=function(n){return function(r){return function(t){var e=Iy(r)(t),a=Yw(ad(n-Ya(e)|0)(0));return Zw(t1(r))(n1(e)(a))}}},a1={x:0,y:0},o1=function(n){return function(r){return{x:n.x+r.x,y:n.y+r.y}}},xy=function(n){return function(r){return function(t){var e=Iy(r)(n),a=e1(Ya(e)+1|0)(r)(t);return r1(function(o){return function(i){return o1(o)(yc(i))}})(a1)(a)}}};var Sp=g(vr),Py=g(xn),Oy=dt(Fr),i1=it(Xv(wn)(Fr)),Ay=ht(wn),$y=as(wn),f1=q(Be),c1=os(wn),l1=Ca(yr),s1=Ft(wt),qy=T(Gn),Mo=C_(Vo),ju=Nd(Ae),p1=Rv(ju),_1=Ov(ju),m1=Mt(Vo),Uy=au(Zn),v1=g(Nt),d1=un(la),D1=Pv(ju),g1=Wv(ju),y1=as(Rl),Fo=x(gp),Ap=Du(sc),tt=s1(gp),er=vu(sc),Hp=zn(_y(Tt)),h1=os(Rl),wo=T(Aa),Ny=ii(Ta),xp=du(sc),b1=yl(wn),T1=q(at),C1=Ua(wn),E1=Zr(wn),Gr=Mt(pc),M1=x(Dr),F1=$v(ju);var Np=function(){function n(){}return n.value=new n,n}(),Gu=function(){function n(){}return n.value=new n,n}(),Rp=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Wp=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Pp=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Op=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),$p=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),qp=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Up=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Bp=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),kp=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),zp=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Vp=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Jp=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Qp=function(){function n(){}return n.value=new n,n}(),Gp=function(){function n(){}return n.value=new n,n}(),jp=function(){function n(){}return n.value=new n,n}(),By=function(){function n(){}return n.value=new n,n}(),hc=function(){function n(){}return n.value=new n,n}(),Kp=function(){function n(){}return n.value=new n,n}(),ky=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),w1=function(n){var r=function(){if(n.coordType instanceof Gu)return Np.value;if(n.coordType instanceof Np)return Gu.value;throw new Error("Failed pattern match at Component.Canvas (line 365, column 17 - line 367, column 32): "+[n.coordType.constructor.name])}();return{maxInt:n.maxInt,maxValue:n.maxValue,power:n.power,norm:n.norm,bubbles:n.bubbles,time:n.time,size:n.size,cache:n.cache,drawnBuffers:n.drawnBuffers,maxTick:n.maxTick,animate:n.animate,lines:n.lines,scale:n.scale,radius:n.radius,addTo:n.addTo,multBy:n.multBy,quadCoeff:n.quadCoeff,cubeCoeff:n.cubeCoeff,sqrt:n.sqrt,cbrt:n.cbrt,circuit:n.circuit,trajectoryFrom:n.trajectoryFrom,coordType:r}},L1=function(n){return{maxInt:n.maxInt,maxValue:n.maxValue,power:n.power,norm:n.norm,bubbles:n.bubbles,time:n.time,size:n.size,coordType:n.coordType,cache:n.cache,drawnBuffers:n.drawnBuffers,maxTick:n.maxTick,animate:n.animate,scale:n.scale,radius:n.radius,addTo:n.addTo,multBy:n.multBy,quadCoeff:n.quadCoeff,cubeCoeff:n.cubeCoeff,sqrt:n.sqrt,cbrt:n.cbrt,circuit:n.circuit,trajectoryFrom:n.trajectoryFrom,lines:!n.lines}},I1=function(n){return{maxInt:n.maxInt,maxValue:n.maxValue,power:n.power,norm:n.norm,bubbles:n.bubbles,time:n.time,size:n.size,coordType:n.coordType,cache:n.cache,drawnBuffers:n.drawnBuffers,maxTick:n.maxTick,lines:n.lines,scale:n.scale,radius:n.radius,addTo:n.addTo,multBy:n.multBy,quadCoeff:n.quadCoeff,cubeCoeff:n.cubeCoeff,sqrt:n.sqrt,cbrt:n.cbrt,circuit:n.circuit,trajectoryFrom:n.trajectoryFrom,animate:!n.animate}};var zy=function(n){return function(r){var t={top:1.5*On(n.scale),left:1.5*On(n.scale)};return Fy(My(On(n.scale))(r))(t)}},x1=function(n){return function(r){var t=On(n.maxValue+1|0),e=wl(Ll(r/t)),a=360*e,o=1-(e*.4+.6),i=1-(e*.6+.4);return Sv(Nv(a)(o)(i))}},Vy=function(n){return Sp(Qt)(fe(0)(n))},A1=function(n){return{maxInt:n.maxInt,maxValue:n.maxValue,power:n.power,norm:n.norm,time:n.time,size:n.size,coordType:n.coordType,cache:n.cache,drawnBuffers:n.drawnBuffers,maxTick:n.maxTick,animate:n.animate,lines:n.lines,scale:n.scale,radius:n.radius,addTo:n.addTo,multBy:n.multBy,quadCoeff:n.quadCoeff,cubeCoeff:n.cubeCoeff,sqrt:n.sqrt,cbrt:n.cbrt,circuit:n.circuit,trajectoryFrom:n.trajectoryFrom,bubbles:Vy(n.maxInt)}},N1=function(n){var r=Oe(Un(1)(_u(n.norm)))(n.power);return{power:n.power,norm:n.norm,maxInt:r,maxValue:r,bubbles:Vy(r),time:D.value,size:n.size,coordType:n.coordType,cache:wr,drawnBuffers:io,maxTick:n.maxTick,animate:!0,lines:!1,scale:n.scale,radius:n.radius,addTo:n.addTo,multBy:n.multBy,quadCoeff:n.quadCoeff,cubeCoeff:n.cubeCoeff,sqrt:n.sqrt,cbrt:n.cbrt,circuit:Un(io)(Py(es)(n.trajectoryFrom)),trajectoryFrom:n.trajectoryFrom}};var S1=function(n){return function(r){return Ui*On(Oy(r)(n.maxInt))/On(n.maxInt)}},H1=function(n){return zt(4*On(n.scale))},R1=function(n){return function(r){var t=function(){var e=rd(n.norm);return e?1:n.maxValue}();return i1(r)(pu(t))}},W1=function(n){return function(r){var t=S1(n)(r),e=R1(n)(nd(n.norm)(r));return{r:Yv(e),theta:t}}},P1=function(n){return function(r){var t=Un(0)(_u(n.norm));return zy(n)(xy(n.maxValue)(t)(r))}},Sy=function(n){return function(r){return function(t){return function(e){var a=Un(t(e.value1))(Ay(e.value1)(r)),o=Ay(e.value0)(r),i=Un(t(e.value0))(o);return{x:n(a.x)(i.x),y:n(a.y)(i.y)}}}}},Hy=function(n){return function(r){return function(t){return x1(r)(n(On(t.value0))(On(t.value1)))}}},O1=function(n){return function(r){return zy(n)(yc(W1(n)(r)))}},Jy=function(n){return function(r){if(n.coordType instanceof Np)return O1(n)(r);if(n.coordType instanceof Gu)return P1(n)(r);throw new Error("Failed pattern match at Component.Canvas (line 146, column 20 - line 148, column 41): "+[n.coordType.constructor.name])}},$1=function(n){return function(r){var t=function(e){return function(a){var o=e,i=!1,c;function f(l,s){if(l instanceof F)return i=!0,s;if(l instanceof M){var m=Un(F.value)(Qa(n)(l.value0)),d=Qi(function(){var p=fn($y)(s);return function(u){return!p(u)}}())(m);o=f1(l.value1)(d),a=c1(l.value0)(s);return}throw new Error("Failed pattern match at Component.Canvas (line 327, column 22 - line 331, column 66): "+[l.constructor.name])}for(;!i;)c=f(o,a);return c}};return t(l1(r))(io)}};var q1=function(n){return function(r){return function(t){return function(e){return function(a){return function(o){return function(){var c=Ts(n)({x0:r.x,y0:r.y,x1:t.x,y1:t.y})();return bf(c)(0)(a)(),bf(c)(1)(o)(),Sc(n)(c)(),ds(n)(e)(),Fu(n)(),yf(n)(r.x)(r.y)(),ys(n)(t.x)(t.y)(),Df(n)(),hf(n)(),void 0}}}}}}},U1=function(n){return function(r){return function(t){return function(e){return Mo(Mo(Mo(Mo(Mo(Mo(Fu(n))(yf(n)(e.x)(e.y)))(hs(n)({x:e.x,y:e.y,radius:r,useCounterClockwise:!0,start:0,end:2*Xa})))(Ds(n)(t)))(gf(n)))(hf(n)))(qy(void 0))}}}},B1=function(n){return function(r){return function(t){return function(e){return function(a){return function(o){return function(i){var c=uo(p1(r.time))(r.maxTick),f=uo(_1(r.time))(r.maxTick),l=new I(i.value0,function(){var u=i.value1<0;return u?Oy(i.value1)(r.maxValue):i.value1}()),s=Hy(c)(r)(l),m=e(l),d=Hy(f)(r)(l),p=t(l);return m1(o(s)(m))(function(){var u=r.lines||$y(l.value0)(r.circuit);return u?q1(n)(p)(m)(a)(d)(s):qy(void 0)}())}}}}}}},k1=function(n){return function(r){return function(t){return function(e){return function(a){return function(o){var i=U1(n)(On(a));return yi(o)(function(c){return yi(Uy(c))(B1(n)(r)(t)(e)(On(a))(i))})}}}}}},z1=function(n){return v1(function(r){return new I(n.value0,r)})(n.value1)},Ry=function(n){return function(r){var t=function(){if(r.norm instanceof Ht)return r.norm.value0;if(r.norm instanceof jt)return 1;throw new Error("Failed pattern match at Component.Canvas (line 375, column 11 - line 377, column 17): "+[r.norm.constructor.name])}();return{maxValue:r.maxValue,norm:r.norm,bubbles:r.bubbles,time:r.time,size:r.size,coordType:r.coordType,cache:r.cache,drawnBuffers:r.drawnBuffers,maxTick:r.maxTick,animate:r.animate,lines:r.lines,scale:r.scale,radius:r.radius,addTo:r.addTo,multBy:r.multBy,quadCoeff:r.quadCoeff,cubeCoeff:r.cubeCoeff,sqrt:r.sqrt,cbrt:r.cbrt,circuit:r.circuit,trajectoryFrom:r.trajectoryFrom,maxInt:Oe(t)(n)-1|0,power:n}}},Qy=function(n){return"bubble-canvas-"+d1(n)},Xp=function(n){var r=uo(D1(n.time))(n.maxTick),t=uo(g1(n.time))(n.maxTick),e=Qy(Un(0)(n.time)),a=Jy(n),o=Sy(r)(n.cache)(a),i=Sy(function(f){return function(l){return l}})(n.cache)(a),c=t(.6)(.25);return function(){var l=sD(e)();if(l instanceof D)return void 0;if(l instanceof v){var s=Un(!1)(Py(fn(y1)(n.drawnBuffers))(n.time));if(s)return void 0;var m=_s(l.value0)(),d=pD(l.value0)();return bs(m)({x:0,y:0,width:d.width,height:d.height})(),gs(m)(c)(),k1(m)(n)(i)(o)(n.radius)(Hi(function(p){return function(u){return z1(new I(p,u))}})(n.bubbles))(),void 0}throw new Error("Failed pattern match at Component.Canvas (line 395, column 5 - line 409, column 22): "+[l.constructor.name])}},Wy=Fo(Ap)(function(n){return tt(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.animate=!1,t}))(function(){return tt(Hp(Xp(n)))(function(){return tt(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.drawnBuffers=h1(Un(0)(n.time))(n.drawnBuffers),t}))(function(){return tt(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.animate=!0,t}))(function(){return wo(void 0)})})})})}),V1=function(n){return function(r){return function(t){return Mp([Ip(Qy(t)),hy(n),Cy(n),Rt("buffer-canvas-"+function(){var e=r===t;return e?"show":"hide"}())])}}},J1=function(n){var r=H1(n);return ee([Ip("animation-station")])(Sp(V1(r)(Un(0)(n.time)))(fe(0)(n.maxInt)))},Q1=function(n){var r=function(){var a=Cd(n.cubeCoeff)(n.quadCoeff)(n.multBy)(n.addTo);return function(o){return Qt(a(o))}}(),t=function(){return n.sqrt?Ny(r)(bd(n.norm)(2*n.power|0)):r}(),e=function(){return n.cbrt?Ny(t)(Td(n.norm)(3*n.power|0)):t}();return e},G1=function(n){return{maxInt:n.maxInt,maxValue:n.maxValue,power:n.power,norm:n.norm,time:n.time,size:n.size,coordType:n.coordType,cache:n.cache,drawnBuffers:n.drawnBuffers,maxTick:n.maxTick,animate:n.animate,lines:n.lines,scale:n.scale,radius:n.radius,addTo:n.addTo,multBy:n.multBy,quadCoeff:n.quadCoeff,cubeCoeff:n.cubeCoeff,sqrt:n.sqrt,cbrt:n.cbrt,circuit:n.circuit,trajectoryFrom:n.trajectoryFrom,bubbles:Sp(Q1(n))(fe(0)(n.maxInt))}},Pr=tt(er(A1))(function(){return Fo(xp(G1))(function(n){var r=uv(Uy)(n.bubbles),t=$1(n.bubbles)(n.trajectoryFrom),e=fe(0)(n.maxInt),a=b1(T1(e)(r)),o=hl(C1)(n.maxInt)(a);return Fo(xp(function(i){return{addTo:i.addTo,animate:i.animate,bubbles:i.bubbles,cache:i.cache,cbrt:i.cbrt,coordType:i.coordType,cubeCoeff:i.cubeCoeff,lines:i.lines,maxInt:i.maxInt,maxTick:i.maxTick,multBy:i.multBy,norm:i.norm,power:i.power,quadCoeff:i.quadCoeff,radius:i.radius,scale:i.scale,size:i.size,sqrt:i.sqrt,time:i.time,trajectoryFrom:i.trajectoryFrom,maxValue:o,drawnBuffers:io,circuit:t}}))(function(i){var c=hl(function(f){return function(l){return E1(l)(Jy(i)(l))(f)}})(wr)(a);return Fo(xp(function(f){return{addTo:f.addTo,animate:f.animate,bubbles:f.bubbles,cbrt:f.cbrt,circuit:f.circuit,coordType:f.coordType,cubeCoeff:f.cubeCoeff,drawnBuffers:f.drawnBuffers,lines:f.lines,maxInt:f.maxInt,maxTick:f.maxTick,maxValue:f.maxValue,multBy:f.multBy,norm:f.norm,power:f.power,quadCoeff:f.quadCoeff,radius:f.radius,scale:f.scale,size:f.size,sqrt:f.sqrt,time:f.time,trajectoryFrom:f.trajectoryFrom,cache:c}}))(function(f){return tt(Hp(Xp(f)))(function(){return wo(void 0)})})})})}),Gy=function(n){if(n instanceof Rp)return Gr(er(Ry(n.value0)))(Pr);if(n instanceof Pp)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.norm=n.value0,t}))(Pr);if(n instanceof Wp)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.maxTick=n.value0,t}))(Pr);if(n instanceof qp)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.addTo=n.value0,t}))(Pr);if(n instanceof Up)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.multBy=n.value0,t}))(Pr);if(n instanceof Bp)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.quadCoeff=n.value0,t}))(Pr);if(n instanceof kp)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.cubeCoeff=n.value0,t}))(Pr);if(n instanceof zp)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.sqrt=n.value0,t}))(Pr);if(n instanceof Vp)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.cbrt=n.value0,t}))(Pr);if(n instanceof Op)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.scale=n.value0,t}))(Pr);if(n instanceof $p)return Gr(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.radius=n.value0,t}))(Pr);if(n instanceof Jp)return tt(er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.trajectoryFrom=n.value0,t}))(function(){return tt(function(){if(n.value0 instanceof D)return er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.circuit=io,t});if(n.value0 instanceof v)return er(function(r){var t={};for(var e in r)({}).hasOwnProperty.call(r,e)&&(t[e]=r[e]);return t.circuit=es(n.value0.value0),t});throw new Error("Failed pattern match at Component.Canvas (line 447, column 3 - line 449, column 57): "+[n.value0.constructor.name])}())(function(){return Pr})});if(n instanceof Qp)return Gr(er(w1))(Pr);if(n instanceof Gp)return Gr(er(L1))(Pr);if(n instanceof jp)return Gr(er(I1))(Pr);if(n instanceof Kp)return Fo(Ap)(function(r){if(!r.animate)return tt(Hp(Xp(r)))(function(){return wo(void 0)});if(r.animate){var t=M1(r.time)(function(e){return uo(F1(e))(r.maxTick)});if(t instanceof v)return tt(er(function(e){var a={};for(var o in e)({}).hasOwnProperty.call(e,o)&&(a[o]=e[o]);return a.time=t,a}))(function(){return tt(Wy)(function(){return wo(void 0)})});if(t instanceof D)return tt(er(function(e){var a={};for(var o in e)({}).hasOwnProperty.call(e,o)&&(a[o]=e[o]);return a.time=new v(Hv),a}))(function(){return tt(Wy)(function(){return wo(void 0)})});throw new Error("Failed pattern match at Component.Canvas (line 462, column 7 - line 470, column 20): "+[t.constructor.name])}throw new Error("Failed pattern match at Component.Canvas (line 456, column 3 - line 470, column 20): "+[r.animate.constructor.name])});if(n instanceof By)return Pr;if(n instanceof hc)return Fo(Ap)(function(r){return tt(er(Ry(r.power)))(function(){return Pr})});throw new Error("Failed pattern match at Component.Canvas (line 423, column 1 - line 423, column 84): "+[n.constructor.name])},j1=function(n){return Gr(Gy(n.value0))(wo(new v(n.value1)))},jy=function(){return Ju({initialState:N1,render:J1,eval:Vu({receive:aa.receive,finalize:aa.finalize,handleAction:Gy,handleQuery:j1,initialize:new v(By.value)})})}();var Ky={compact:Ho(Dr),separate:function(n){if(n instanceof D)return{left:D.value,right:D.value};if(n instanceof v){if(n.value0 instanceof gn)return{left:new v(n.value0.value0),right:D.value};if(n.value0 instanceof yn)return{left:D.value,right:new v(n.value0.value0)};throw new Error("Failed pattern match at Data.Compactable (line 91, column 23 - line 93, column 48): "+[n.value0.constructor.name])}throw new Error("Failed pattern match at Data.Compactable (line 87, column 1 - line 93, column 48): "+[n.constructor.name])}};var rL=function(n){return n.partitionMap};var tL=function(n){return function(r){var t=n(r);return t?new v(r):D.value}};var eL=function(n){return n.filterMap};var aL=function(n){var r=eL(n);return function(t){return r(tL(t))}},Xy=function(n){return n.filter};var oL=function(n){return function(r){var t=n(r);return t?new yn(r):new gn(r)}};var uL=function(n){var r=rL(n);return function(t){return function(e){var a=r(oL(t))(e);return{no:a.left,yes:a.right}}}};var bc={partitionMap:function(n){return function(r){if(r instanceof D)return{left:D.value,right:D.value};if(r instanceof v){var t=n(r.value0);if(t instanceof gn)return{left:new v(t.value0),right:D.value};if(t instanceof yn)return{left:D.value,right:new v(t.value0)};throw new Error("Failed pattern match at Data.Filterable (line 161, column 29 - line 163, column 48): "+[t.constructor.name])}throw new Error("Failed pattern match at Data.Filterable (line 159, column 1 - line 169, column 29): "+[n.constructor.name,r.constructor.name])}},partition:function(n){return uL(bc)(n)},filterMap:Yn(Dr),filter:function(n){return aL(bc)(n)},Compactable0:function(){return Ky},Functor1:function(){return xn}};var fL=Ep();var Yy=function(){return function(n){var r=fL(n);return function(t){var e=r(t);return function(a){return function(o){return function(i){return function(c){return Cg(new zu(e(a)(o)(i)(c)($(D.value))))}}}}}}};var sL=gr();var Zy=function(n){return sL(fs(n))};function nh(n,r,t,e){return e==null?n:r(e[t])}var mL=function(n){var r=Ys(n),t=T(Tu(n));return function(e){return function(a){return nh(r(new Xs("object",Wu(a))),t,e,a)}}},rh=function(n){return mL(n)};function th(n){return n.currentTarget}var eh=function(n){return Vn(th(n))};var Yp="DOMContentLoaded";var Zp="change";var uh="click";var xL=g(xn),AL=ii(Dr),NL=So(cf(Ae)),SL=rh(Ae),HL=cg(Ae);var RL=y;var WL=function(n){return function(r){return Vf(n)(function(t){return xL(Ke.create)(r(t))})}},PL=function(n){return function(r){return Vf(n)(function(t){return new v(new Ke(r(t)))})}};var ih=function(){var n=PL(uh);return function(r){return n(RL(r))}}();var fh=function(n){return function(r){return function(t){return function(e){var a=function(o){return NL(t)(SL(r))(ug(o))};return WL(n)(AL(eh)(function(o){return vt($(D.value))(function(i){return v.create(e(i))})(Zy(a(o)))}))}}}},ch=fh(Zp)("checked")(fg(Ae));var lh=fh(Zp)("value")(HL);function sh(n,r,t){var e=Object.prototype.toString.call(t);return e.indexOf("[object HTML")===0&&e.indexOf("Element]")===e.length-8?r(t):n}var ph=y;var n_=function(n){return sh(D.value,v.create,n)};var GL=qn(Bu);var jL=cc();var t_=function(){return function(n){var r=jL(n);return function(t){var e=r(t);return function(a){return function(o){return function(i){return GL(e(a)(o)(i(void 0)))}}}}}};var e_=function(n){return n(void 0)};var Dh={reflectSymbol:function(){return"canvas"}},KL=t_()(Dh)($o),Tr=T(Aa),Cr=Mt(pc),XL=Yy()(Dh)($o),dh=Lp(wg),YL=Na(zf),ZL=g(xn),nI=Lp(Lg),Fe=un(la),gh=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),yh=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),hh=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),bh=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Th=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Ch=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Eh=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Mh=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Fh=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),wh=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Lh=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),Ih=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}(),xh=function(){function n(){}return n.value=new n,n}(),Ah=function(){function n(){}return n.value=new n,n}(),Nh=function(){function n(){}return n.value=new n,n}(),Sh=function(){function n(){}return n.value=new n,n}(),a_=function(){function n(){}return n.value=new n,n}(),Hh=function(){function n(){}return n.value=new n,n}(),Rh=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),rI=function(){var n=Xy(bc)(function(r){return r>=0});return function(r){return n(vv(r))}}(),ae=function(){return{size:1024,power:5,norm:new Ht(3),coordType:Gu.value,maxTick:64,scale:200,radius:1,addTo:1,multBy:1,quadCoeff:0,cubeCoeff:0,sqrt:!1,cbrt:!1,trajectoryFrom:D.value}}(),Wh=function(){return Ar.value}(),Ir=function(n){var r=function(t){return ky.create(t)};return KL(Wh)(void 0)(r(n))},Ph=function(n){if(n instanceof Hh)return Tr(void 0);if(n instanceof gh){var r=function(){var t=n.value0<=1;return t?jt.value:new Ht(n.value0)}();return Cr(Cr(Ir(new Pp(r)))(Ir(hc.value)))(Tr(void 0))}if(n instanceof yh)return Cr(Ir(new Rp(n.value0)))(Tr(void 0));if(n instanceof hh)return Cr(Ir(new Wp(n.value0)))(Tr(void 0));if(n instanceof bh)return Cr(Ir(new Op(n.value0)))(Tr(void 0));if(n instanceof Th)return Cr(Ir(new $p(n.value0)))(Tr(void 0));if(n instanceof Ch)return Cr(Ir(new qp(n.value0)))(Tr(void 0));if(n instanceof Eh)return Cr(Ir(new Up(n.value0)))(Tr(void 0));if(n instanceof Mh)return Cr(Ir(new Bp(n.value0)))(Tr(void 0));if(n instanceof Fh)return Cr(Ir(new kp(n.value0)))(Tr(void 0));if(n instanceof wh)return Cr(Ir(new zp(n.value0)))(Tr(void 0));if(n instanceof Lh)return Cr(Ir(new Vp(n.value0)))(Tr(void 0));if(n instanceof Ih)return Cr(Ir(new Jp(n.value0)))(Tr(void 0));if(n instanceof xh)return Cr(Ir(Qp.value))(Tr(void 0));if(n instanceof Nh)return Cr(Ir(Gp.value))(Tr(void 0));if(n instanceof Ah)return Cr(Ir(jp.value))(Tr(void 0));if(n instanceof Sh)return Cr(Ir(hc.value))(Tr(void 0));if(n instanceof a_)return Cr(Ir(Kp.value))(Tr(void 0));throw new Error("Failed pattern match at Component.App (line 162, column 1 - line 162, column 91): "+[n.constructor.name])},tI=function(n){return Cr(Ph(n.value0))(Tr(new v(n.value1)))},eI=function(n){var r=function(f){return function(l){return function(s){var m=Hn([])(function(d){return[ee([Rt("description")])([mo(d)])]})(l);return ee([Rt(s)])(Tl(f)(m))}}},t=ee([Rt("pure-u-3-4")])([XL(Wh)(void 0)(jy)(ae)]),e=function(f){return function(l){return function(s){return function(m){var d=Dc([dc([mo(f+": ")]),vc([Rt("attr-numeric"),dh(wf.value),lh(function(p){return m(rI(p))}),wp(f),YL("maxLength")(4),by(Un("")(l)),Ty(0)])]);return r(d)(s)("input-div")}}}},a=function(f){return function(l){return function(s){return function(m){return e(f)(new v(l))(s)(function(){var d=Un(Hh.value),p=ZL(m);return function(u){return d(p(u))}}())}}}},o=function(f){return function(l){return function(s){var m=Dc([dc([mo(f+": ")]),vc([Rt("attr-boolean"),dh(Ff.value),ch(s),wp(f)])]);return r(m)(l)("checkbox-div")}}},i=function(f){return function(l){return function(s){return function(m){var d=Fp([Rt("pure-button button-"+l),ih(function(p){return m}),nI(Mf.value)])([mo(f)]);return r(d)(s)("button-div")}}}},c=ee([Rt("pure-u-1-4 sidebar")])([i("Toggle Representation")("primary")(new v("Between fractal given by the p-adic representation, or circles given by the p-adic norm"))(xh.value),i("Toggle Animation")("warning")(new v("Turn animation on and off"))(Ah.value),i("Toggle Lines")("secondary")(new v("Turn lines on and off"))(Nh.value),i("Reset")("error")(new v("Reset animation"))(Sh.value),a("_-adic Norm")(Fe(Un(0)(_u(ae.norm))))(new v("<= 1 yields normal absolute value; 2 and above use p-adic norm"))(gh.create),a("# of Frames")(Fe(ae.maxTick))(new v("Frames between each position; controls speed of animation"))(hh.create),a("p^# of Circles")(Fe(ae.power))(new v("Use this p^(power) many circles; for example, in the 3-adic norm, setting this to 3 will use 27 circles"))(yh.create),a("Scale")(Fe(ae.scale))(new v("Controls distance between dots"))(bh.create),a("Radius")(Fe(ae.radius))(new v("Controls size of dots"))(Th.create),a("Constant Term")(Fe(ae.addTo))(new v("Set constant term in ax^3 + bx^2 + cx + d"))(Ch.create),a("Linear Coefficient")(Fe(ae.multBy))(new v("Set linear component"))(Eh.create),a("Quad Coefficient")(Fe(ae.quadCoeff))(new v("Set quadratic component"))(Mh.create),a("Cubic Coefficient")(Fe(ae.cubeCoeff))(new v("Set cubic component"))(Fh.create),o("Square Root?")(new v("Take square root of the above"))(wh.create),o("Cube Root?")(new v("Take cube root of the above"))(Lh.create),e("Show Trajectory From")(D.value)(new v("Draw line for full circuit from starting point"))(Ih.create)]);return ee([Rt("pure-g")])([c,t])},Oh=function(){return Ju({initialState:$(void 0),render:eI,eval:Vu({receive:aa.receive,initialize:aa.initialize,finalize:aa.finalize,handleAction:Ph,handleQuery:tI})})}();var Sa=function(){return window};function $h(n){return n.readyState}var Ku=function(){function n(){}return n.value=new n,n}(),fI=function(){function n(){}return n.value=new n,n}(),cI=function(){function n(){}return n.value=new n,n}();var qh=function(n){return n==="loading"?new v(Ku.value):n==="interactive"?new v(fI.value):n==="complete"?new v(cI.value):D.value};var sI=g(sn);var Bh=y;var kh=y;var zh=function(n){return sI(function(){var r=Un(Ku.value);return function(t){return r(qh(t))}}())(function(){return $h(n)})};function Lo(n){return function(){return n.document}}var Gh=y;var Xh=x(kr),tx=zn(Tt),o_=Yn(ft),ex=So(ft),Yh=T(te),ax=Yn(Dr),ox=T(Gn),ux=g(sn),ix=Ft(wt),fx=Qr(mf),cx=function(n){return Xh(tx(o_(ex(function(){var r=YD(n);return function(t){return r(Bh(t))}}())(Lo))(Sa)))(function(r){return Yh(ax(n_)(r))})},Zh=vf(vt(he)($(ox(void 0)))),lx=fo(function(n){return function(){var t=o_(zh)(o_(Lo)(Sa))();if(t instanceof Ku){var e=ux(Gh)(Sa)(),a=Pu(function(o){return n(new yn(void 0))})();return tp(Yp)(a)(!1)(e)(),_f(ep(Yp)(a)(!1)(e))}return n(new yn(void 0))(),cD}}),nb=ix(kr)(lx)(function(){return Xh(cx("body"))(function(n){return Hn(fx(bt("Could not find body")))(Yh)(n)})});var Tc={suspend:Zd,fork:nD,join:Eu,Monad0:function(){return Fa},Functor1:function(){return uD}};var Cc=function(n){return n.fork};var Ec=function(n){return function(){console.warn(n)}};var tb=y,Wt=y,eb=function(n){var r=cr(n)(yr);return function(t){return Wt(function(e){return r(t)(e.rendering)})}},gx=y,ab=function(n){return function(r){return Wt(function(t){return gx(r(t.rendering))})}},yx=y,Mc=function(n){return function(r){return n(r)}},ob=function(n){return function(r){return function(t){return function(e){return function(){var o=jn({})(),i=jn(po)(),c=jn(po)(),f=jn(t)(),l=jn(new v(F.value))(),s=jn(new v(F.value))(),m=jn(D.value)(),d=jn(1)(),p=jn(new v(wr))(),u=jn(wr)(),_={component:n,state:n.initialState(r),refs:wr,children:po,childrenIn:i,childrenOut:c,selfRef:o,handlerRef:f,pendingQueries:l,pendingOuts:s,pendingHandlers:m,rendering:D.value,fresh:d,subscriptions:p,forks:u,lifecycleHandlers:e};return Pn(_)(o)(),yx(o)}}}}};var hx=cr(Gn)(yr),bx=Yn(Dr),Tx=ht(Dp),ir=x(kr),kn=zn(Tt),Cx=Ft(wt),Pt=Cx(kr),sb=cr(te),Ex=sb(Zn),pb=Cc(Tc),Mx=Cu(wa)(Zn),oe=T(te),Fx=g(Es),ub=Qe(wa),wx=g(Ge),ib=lo(wa),Lx=g(xn),Ix=Zr(Dp),xx=Wg(ps),Ax=Zi(lc),Nx=H_(me),Sx=Zr(lc),fb=sb(yr),cb=ht(lc),Hx=ht(Vr),Rx=Yg(df),Wx=to(Vr),Px=function(n){return function(r){return function(){var e=z(r)(),a=z(e.subscriptions)();return hx(Zf)(bx(Tx(n))(a))()}}},Fc=function(n){return function(r){return ir(kn(z(n)))(function(t){if(t instanceof D)return r;if(t instanceof v)return kn(Pn(new v(new M(r,t.value0)))(n));throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 188, column 33 - line 190, column 57): "+[t.constructor.name])})}},wc=function(n){return function(r){return Pt(kn(Pn({initializers:F.value,finalizers:F.value})(n)))(function(){return ir(kn(r))(function(t){return ir(kn(z(n)))(function(e){return Pt(Ex(pb)(e.finalizers))(function(){return Pt(Mx(e.initializers))(function(){return oe(t)})})})})})}},Ha=vf(vt(he)($(T(Gn)(void 0)))),lb=function(n){return function(r){return ir(kn(z(r)))(function(t){return kn(Vc(function(e){return{state:e+1|0,value:n(e)}})(t.fresh))})}},i_=function(n){return function(r){return function(t){return ir(kn(z(r)))(function(e){return oa(n)(r)(e.component.eval(new Co(Fx(v.create)(dD(t)),$(D.value))))})}}},oa=function(n){return function(r){return function(t){var e=function(o){return function(i){return ir(kn(z(o)))(function(c){return ey(function(f){var l=function(s){return ub(ir(kn(z(s)))(function(m){return Wt(function(d){return i_(n)(d.selfRef)(f.value1)})(m)}))};return wx(f.value2)(ib(f.value0(ps)(l)(c.children)))})(i)})}},a=function(o){return function(i){if(i instanceof $u)return ir(kn(z(o)))(function(c){var f=i.value0(c.state);if(go(c.state)(f.value1))return oe(f.value0);if(Sn)return Pt(kn(Pn({component:c.component,refs:c.refs,children:c.children,childrenIn:c.childrenIn,childrenOut:c.childrenOut,selfRef:c.selfRef,handlerRef:c.handlerRef,pendingQueries:c.pendingQueries,pendingOuts:c.pendingOuts,pendingHandlers:c.pendingHandlers,rendering:c.rendering,fresh:c.fresh,subscriptions:c.subscriptions,forks:c.forks,lifecycleHandlers:c.lifecycleHandlers,state:f.value1})(o)))(function(){return Pt(wc(c.lifecycleHandlers)(n(c.lifecycleHandlers)(o)))(function(){return oe(f.value0)})});throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 86, column 7 - line 92, column 21): "+[f.constructor.name])});if(i instanceof nc)return ir(lb(ly)(o))(function(c){return ir(kn(uy(i.value0(c))(function(f){return Ha(f_(n)(o)(new Ke(f)))})))(function(f){return ir(kn(z(o)))(function(l){return Pt(kn(ct(Lx(Ix(c)(f)))(l.subscriptions)))(function(){return oe(i.value1(c))})})})});if(i instanceof rc)return Pt(kn(Px(i.value0)(o)))(function(){return oe(i.value1)});if(i instanceof qu)return i.value0;if(i instanceof Uu)return e(o)(i.value0);if(i instanceof tc)return ir(kn(z(o)))(function(c){return ir(kn(z(c.handlerRef)))(function(f){return Pt(Fc(c.pendingOuts)(f(i.value0)))(function(){return oe(i.value1)})})});if(i instanceof ec)return ib(xx(cp(function(){var c=oa(n)(o);return function(f){return ub(c(f))}}())(i.value0)));if(i instanceof ac)return ir(lb(sy)(o))(function(c){return ir(kn(z(o)))(function(f){return ir(kn(jn(!1)))(function(l){return ir(pb(oD(kn(function(){return ct(Ax(c))(f.forks)(),Pn(!0)(l)()}))(oa(n)(o)(i.value0))))(function(s){return Pt(kn(Nx(z(l))(ct(Sx(c)(s))(f.forks))))(function(){return oe(i.value1(c))})})})})});if(i instanceof oc)return ir(kn(z(o)))(function(c){return ir(kn(z(c.forks)))(function(f){return Pt(fb(Eu)(cb(i.value0)(f)))(function(){return oe(i.value1)})})});if(i instanceof uc)return ir(kn(z(o)))(function(c){return ir(kn(z(c.forks)))(function(f){return Pt(fb(Mu(bt("Cancelled")))(cb(i.value0)(f)))(function(){return oe(i.value1)})})});if(i instanceof ic)return ir(kn(z(o)))(function(c){return oe(i.value1(Hx(i.value0)(c.refs)))});throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 83, column 12 - line 139, column 33): "+[i.constructor.name])}};return Rx(a(r))(t)}}},f_=function(n){return function(r){return function(t){if(t instanceof ws)return kn(fn(ct)(r)(Mc(function(e){return{component:e.component,state:e.state,children:e.children,childrenIn:e.childrenIn,childrenOut:e.childrenOut,selfRef:e.selfRef,handlerRef:e.handlerRef,pendingQueries:e.pendingQueries,pendingOuts:e.pendingOuts,pendingHandlers:e.pendingHandlers,rendering:e.rendering,fresh:e.fresh,subscriptions:e.subscriptions,forks:e.forks,lifecycleHandlers:e.lifecycleHandlers,refs:Wx($(t.value1))(t.value0)(e.refs)}})));if(t instanceof Ke)return ir(kn(z(r)))(function(e){return oa(n)(r)(e.component.eval(new To(t.value0,void 0)))});throw new Error("Failed pattern match at Halogen.Aff.Driver.Eval (line 52, column 20 - line 58, column 62): "+[t.constructor.name])}}};var $x=x(ft),qx=Ft(wt),yb=Li(Gn)(yr),hb=cr(te)(Zn),bb=Cc(Tc),Yu=Yn(ft),Tb=cr(Gn),Cb=Tb(yr),_b=Tb(br),mb=qx(kr),Ux=Cu(wa)(Zn),Xu=zn(Tt),vb=T(Gn),c_=g(sn),l_=T(te),s_=$t(Gn),Bx=ab(sn),kx=qn(Ge),db=hD(Gn),zx=eb(Gn),Vx=lt(vm),Jx=Wa(sn),p_=x(kr),Qx=zn(Fd),Db=function(){return jn({initializers:F.value,finalizers:F.value})}(),gb=function(n){return function(){var t=z(n)();return Pn(D.value)(n)(),yb(t)(function(){var e=hb(bb);return function(a){return Ha(e(Gt(a)))}}())()}},Gx=function(n){return function(){return Yu(Cb(_b(Zf)))(z(n.subscriptions))(),Pn(D.value)(n.subscriptions)(),Yu(_b(function(){var t=Mu(bt("finalized"));return function(e){return Ha(t(e))}}()))(z(n.forks))(),Pn(wr)(n.forks)()}},Eb=function(n){return function(r){return function(t){var e=function(s){return function(m){return Wt(function(d){var p=oa(i)(d.selfRef)(d.component.eval(new yo(void 0)));return ct(function(u){return{initializers:new M(mb(Ux(Gt(u.initializers)))(function(){return mb(p)(function(){return Xu(function(){return gb(d.pendingQueries)(),gb(d.pendingOuts)()})})}),m),finalizers:u.finalizers}})(s)})}},a=function(s){return function(m){return function(d){return Cp(function(p){return function(){var _=Db(),H=ob(p)(d)(m)(_)(),pn=z(s)();return Pn({initializers:F.value,finalizers:pn.finalizers})(s)(),Yu(Wt(function(){var Dn=i(s);return function(In){return Dn(function(tn){return tn.selfRef}(In))}}()))(z(H))(),Yu(e(s)(pn.initializers))(z(H))(),H}})}}},o=function(s){return function(m){return function(d){return function(p){return Tp(function(u){return function(){var H=c_(u.pop)(z(d))(),pn=function(){if(H instanceof v){Pn(H.value0.value1)(d)();var In=z(H.value0.value0)();return Wt(function(tn){return function(){return fn(Pn)(tn.handlerRef)(function(){var Jn=Hn(l_(void 0))(m);return function(Ct){return Jn(u.output(Ct))}}())(),Ha(oa(i)(tn.selfRef)(tn.component.eval(new bo(u.input,void 0))))()}})(In)(),H.value0.value0}if(H instanceof D)return a(s)(function(){var tn=Hn(l_(void 0))(m);return function(S){return tn(u.output(S))}}())(u.input)(u.component)();throw new Error("Failed pattern match at Halogen.Aff.Driver (line 213, column 14 - line 222, column 98): "+[H.constructor.name])}(),Dn=c_(function(In){return Ba(u.get(In))})(z(p))();return s_(Dn)(Ec("Halogen: Duplicate slot address was detected during rendering, unexpected results may occur"))(),ct(u.set(pn))(p)(),$x(z(pn))(Bx(function(In){if(In instanceof D)return Md("Halogen internal error: child was not initialized in renderChild");if(In instanceof v)return vb(n.renderChild(In.value0));throw new Error("Failed pattern match at Halogen.Aff.Driver (line 227, column 37 - line 229, column 50): "+[In.constructor.name])}))()}})}}}},i=function(s){return function(m){return function(){var p=z(m)(),u=c_(pe)(z(p.pendingHandlers))();s_(u)(Pn(new v(F.value))(p.pendingHandlers))(),Pn(po)(p.childrenOut)(),Pn(p.children)(p.childrenIn)();var _=function(){var tn=Fc(p.pendingHandlers),S=f_(i)(p.selfRef);return function(Jn){return tn(kx(S(Jn)))}}(),H=function(){var tn=Fc(p.pendingQueries);return function(S){return tn(_(Ke.create(S)))}}(),pn=n.render(function(tn){return Ha(_(tn))})(o(s)(H)(p.childrenIn)(p.childrenOut))(p.component.render(p.state))(p.rendering)(),Dn=z(p.childrenOut)(),In=z(p.childrenIn)();return db(In)(function(tn){return function(){var Jn=z(tn)();return zx(n.removeChild)(Jn)(),c(s)(Jn)()}})(),fn(ct)(p.selfRef)(Mc(function(tn){return{component:tn.component,state:tn.state,refs:tn.refs,childrenIn:tn.childrenIn,childrenOut:tn.childrenOut,selfRef:tn.selfRef,handlerRef:tn.handlerRef,pendingQueries:tn.pendingQueries,pendingOuts:tn.pendingOuts,pendingHandlers:tn.pendingHandlers,fresh:tn.fresh,subscriptions:tn.subscriptions,forks:tn.forks,lifecycleHandlers:tn.lifecycleHandlers,rendering:new v(pn),children:Dn}}))(),s_(u)(fn(Vx)(void 0)(function(tn){return function(){var Jn=z(p.pendingHandlers)();Pn(new v(F.value))(p.pendingHandlers)(),Cb(function(){var xc=hb(bb);return function(Ac){return Ha(xc(Gt(Ac)))}}())(Jn)();var Ct=z(p.pendingHandlers)(),Ic=Hn(!1)(Gv)(Ct);return Ic?Jx(Pn(D.value)(p.pendingHandlers))(new sr(void 0))():new pr(void 0)}}))()}}},c=function(s){return Wt(function(m){return function(){Gx(m)();var p=oa(i)(m.selfRef)(m.component.eval(new ho(void 0)));return ct(function(u){return{initializers:u.initializers,finalizers:new M(p,u.finalizers)}})(s)(),db(m.children)(function(u){return function(){var H=z(u)();return c(s)(H)()}})()}})},f=function(s){return function(m){return function(d){return p_(Xu(z(s)))(function(p){return p?l_(D.value):i_(i)(m)(d)})}}},l=function(s){return function(m){return function(d){return wc(m)(function(){var u=z(s)();return u?void 0:(Pn(!0)(s)(),c(m)(d)(),Wt(function(_){return function(){var pn=Qx(z(_.selfRef))();return yb(pn.rendering)(n.dispose)()}})(d)())})}}};return p_(Xu(Db))(function(s){return p_(Xu(jn(!1)))(function(m){return wc(s)(function(){var p=fy(),u=Yu(z)(a(s)(function(){var _=iy(p.listener);return function(H){return Xu(_(H))}}())(t)(r))();return Wt(function(_){return vb({query:f(m)(_.selfRef),messages:p.emitter,dispose:l(m)(s)(u)})})(u)()})})})}}};var Ot=function(n){return function(r){return function(){return r[n]}}};var Kx=Ot("baseURI"),Xx=Ot("ownerDocument"),Mb=Ot("parentNode"),Yx=Ot("parentElement");var Zx=Ot("childNodes"),nA=Ot("firstChild"),rA=Ot("lastChild"),tA=Ot("previousSibling"),Fb=Ot("nextSibling"),eA=Ot("nodeValue");var aA=Ot("textContent");function __(n){return function(r){return function(t){return function(){t.insertBefore(n,r)}}}}function Lc(n){return function(r){return function(){r.appendChild(n)}}}function m_(n){return function(r){return function(){r.removeChild(n)}}}var wb=g(sn);var v_=function(){var n=wb(Vn);return function(r){return n(Mb(r))}}();var Lb=function(){var n=wb(Vn);return function(r){return n(Fb(r))}}();var d_=function(n,r,t){var e=0,a;return function(o){if(e===2)return a;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+o+")",r,o);return e=1,a=t(),e=2,a}},D_=qn(sn),cA=T(Gn),lA=cr(Gn)(yr),sA=gr(),pA=$t(Gn),_A=ve(Ci(Ci(It))),mA=X(Y),vA=x(kr),dA=zn(Tt),DA=g(sn),gA=Yn(ft);var yA=function(n){return function(r){return function(t){return r instanceof v&&t instanceof v?D_(__(n)(r.value0)(t.value0)):r instanceof D&&t instanceof v?D_(Lc(n)(t.value0)):cA(void 0)}}},Ib=function(n){return function(){var t=v_(n.node)();return lA(function(e){return m_(n.node)(e)})(t)()}},hA=function(n){return function(r){return function(t){var e=tb(function(c){return c.node}),a=function(c){return c instanceof v?rt(c.value0):void 0},o=function(c){var f=vy(sA)(c),l=d_("patch","Halogen.VDom.Driver",function(){return function(_,H){if(_ instanceof v){if(H instanceof zu)return rt(_.value0),m(100)(H.value0);if(H instanceof mc){var pn=nt(_.value0,H.value0);return tr(new rr(Wr(pn),new v(pn),l(103),a))}throw new Error("Failed pattern match at Halogen.VDom.Driver (line 97, column 22 - line 103, column 79): "+[H.constructor.name])}return s(104)(H)}}),s=d_("render","Halogen.VDom.Driver",function(){return function(_){if(_ instanceof zu)return m(86)(_.value0);if(_ instanceof mc){var H=f(_.value0);return tr(new rr(Wr(H),new v(H),l(89),a))}throw new Error("Failed pattern match at Halogen.VDom.Driver (line 84, column 7 - line 89, column 75): "+[_.constructor.name])}}),m=d_("renderComponentSlot","Halogen.VDom.Driver",function(){return function(_){var H=z(r)(),pn=H(_)(),Dn=e(pn);return tr(new rr(Dn,D.value,l(117),a))}}),d=l(91),p=s(82),u=m(109);return p},i=yg(n);return{buildWidget:o,buildAttributes:i,document:t}}}},bA=function(n){return function(r){var t=function(e){return function(a){return function(o){return function(i){if(i instanceof D)return function(){var f=jn(a)(),l=hA(e)(f)(n),s=Ru(l)(o),m=Wr(s);return D_(Lc(m)(ph(r)))(),{machine:s,node:m,renderChildRef:f}};if(i instanceof v)return function(){Pn(a)(i.value0.renderChildRef)();var f=v_(i.value0.node)(),l=Lb(i.value0.node)(),s=nt(i.value0.machine,o),m=Wr(s);return pA(_A(go)(i.value0.node)(m))(yA(m)(l)(f))(),{machine:s,node:m,renderChildRef:i.value0.renderChildRef}};throw new Error("Failed pattern match at Halogen.VDom.Driver (line 157, column 5 - line 173, column 80): "+[i.constructor.name])}}}};return{render:t,renderChild:mA,removeChild:Ib,dispose:Ib}}},xb=function(n){return function(r){return function(t){return vA(dA(DA(kh)(gA(Lo)(Sa))))(function(e){return Eb(bA(e)(t))(n)(r)})}}};var g_=x(kr),CA=dm(df),EA=qn(Ge),MA=function(){return 1/60}(),Ab=Zh(g_(nb)(function(n){return g_(xb(Oh)(void 0)(n))(function(r){return CA(g_(tD(MA))(function(){return EA(r.query(e_(Rh.create(a_.value))))}))})}));Ab();})();
